"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7958],{7958:(P,y,r)=>{r.r(y),r.d(y,{ReportAttachmentListPage:()=>B});var f=r(467),l=r(9893),p=r(177),v=r(9417),t=r(4438),b=r(600),C=r(3629),o=r(9012),h=r(7031),m=r(9934),M=r(5351),D=r(345),E=r(8135);function O(s,d){if(1&s){const a=t.RV6();t.j41(0,"ion-col",11)(1,"ion-checkbox",12),t.bIt("ionChange",function(i){const n=t.eBV(a).$implicit,c=t.XpG(2);return t.Njj(c.fileChecked(i,n))}),t.mxI("ngModelChange",function(i){const n=t.eBV(a).$implicit;return t.DH7(n.isSelected,i)||(n.isSelected=i),t.Njj(i)}),t.k0s(),t.j41(2,"ion-button",13)(3,"ion-thumbnail",14)(4,"img",15),t.bIt("click",function(){const i=t.eBV(a).$implicit,n=t.XpG(2);return t.Njj(n.openFile(i))}),t.k0s()(),t.j41(5,"div",16),t.bIt("click",function(){const i=t.eBV(a).$implicit,n=t.XpG(2);return t.Njj(n.openFile(i))}),t.j41(6,"span",17),t.EFF(7),t.k0s()()(),t.j41(8,"div",18)(9,"strong"),t.EFF(10),t.k0s()()()}if(2&s){const a=d.$implicit,e=t.XpG(2);t.R7$(),t.Y8G("hidden",e.hideCheckBox),t.R50("ngModel",a.isSelected),t.R7$(),t.Y8G("disabled",e.disableThumbnailClick),t.R7$(),t.Y8G("hidden","image"!=a.contentType.split("/")[0])("ngClass",e.currentUpload&&e.currentUpload.fileName==a.fileName?"thumbnailSize gray-border":"thumbnailSize"),t.R7$(),t.Y8G("src",e.sanitizeURI(a.thumbnailBase64DataURI),t.B4B),t.R7$(),t.Y8G("hidden","image"==a.contentType.split("/")[0]),t.R7$(2),t.SpI(" ",a.contentType.split("/")[1]," "),t.R7$(3),t.SpI(" ",a.fileName," ")}}function R(s,d){if(1&s&&(t.j41(0,"div",4)(1,"ion-grid",5)(2,"ion-row",6)(3,"ion-col",7)(4,"strong"),t.EFF(5),t.nI1(6,"date"),t.k0s()(),t.j41(7,"ion-col",8),t.nrm(8,"div",9),t.k0s()(),t.j41(9,"ion-row")(10,"ion-grid")(11,"ion-row"),t.DNE(12,O,11,9,"ion-col",10),t.k0s()()()()()),2&s){const a=d.$implicit,e=t.XpG();t.R7$(5),t.SpI(" ",t.i5U(6,2,e.stringToDate(a),"dd MMM yyyy")," "),t.R7$(7),t.Y8G("ngForOf",e.attachments[a])}}function k(s,d){if(1&s){const a=t.RV6();t.j41(0,"ion-label",23),t.bIt("click",function(){t.eBV(a);const i=t.XpG(2);return t.Njj(i.shareAttachmentToVisit())}),t.EFF(1," SHARE "),t.k0s()}}function A(s,d){if(1&s){const a=t.RV6();t.j41(0,"ion-footer",6)(1,"ion-toolbar")(2,"ion-grid")(3,"ion-row")(4,"ion-col",19),t.EFF(5),t.k0s(),t.j41(6,"ion-col",20),t.DNE(7,k,2,0,"ion-label",21),t.k0s(),t.j41(8,"ion-col",22)(9,"ion-label",23),t.bIt("click",function(){t.eBV(a);const i=t.XpG();return t.Njj(i.unmarkAttachments())}),t.EFF(10," CANCEL "),t.k0s()()()()()()}if(2&s){const a=t.XpG();t.R7$(5),t.SpI(" ",a.selectedAttachments.length," items selected "),t.R7$(2),t.Y8G("ngIf",a.appointment)}}let B=(()=>{var s;class d{constructor(e,i,n,c,_,x,I,S,T,U){var g,u;this.platform=e,this.navController=i,this.storageService=n,this.router=c,this.dateService=_,this.alertController=x,this.utilityService=I,this.dialog=S,this.domSanitizer=T,this.pageNavService=U,this.attachments=[],this.body={familyMemberId:"",fileName:"",contentType:"",datetime:new Date,thumbnailBase64DataURI:"",base64DataURI:""},this.selectedAttachments=[],this.hideCheckBox=!0,this.disableThumbnailClick=!1,this.user=this.storageService.get("user"),this.familyMemberId=null===(g=this.router.getCurrentNavigation())||void 0===g||null===(g=g.extras.state)||void 0===g?void 0:g.familyMemberId,this.appointment=null===(u=this.router.getCurrentNavigation())||void 0===u||null===(u=u.extras.state)||void 0===u?void 0:u.appointment,this.hideCheckBox=!this.appointment,this.getAttachments()}ionViewWillEnter(){this.disableThumbnailClick=!1,this.pageNavService.setupBackButton([{route:"/medical-record/report-attachment-list",handler:()=>this.router.navigate(["home"])},{route:"/home/medical-record/report-attachment-list",handler:()=>this.router.navigate(["/home"])},{route:"/attachment-list",handler:()=>this.router.navigate(["appointment-details"])},{route:"/home/attachment-list",handler:()=>this.router.navigate(["/home/appointment-details"])}])}getAttachments(){var e=this;return(0,f.A)(function*(){e.httpService.getInBackground("/attachment/resultAttachment/?familyMemberId="+e.familyMemberId,!0).then(n=>{n.length>0?(e.attachmentDates=Object.keys(n),e.attachments=e.deSelectAllAttachments(n)):document.getElementById("noReports").hidden=!1}).catch(n=>{})})()}openFile(e){this.disableThumbnailClick=!0,this.httpService.getInBackground("/attachment/contextAttachment/open/?hospitalCode="+e.entityCode+"&attachmentId="+e.id,!0).then(n=>{}).catch(n=>{this.utilityService.presentAlert("Error!",n.message),this.disableThumbnailClick=!1})}toDBdateFormat(e){return this.dateService.toDBdateFormat(new Date(e))}sanitizeURI(e){return this.domSanitizer.bypassSecurityTrustResourceUrl(e)}getTime(e){return this.dateService.to12HourFormat(new Date(e).getHours()+":"+new Date(e).getMinutes())}ionViewWillLeave(){this.dialog.closeAll()}stringToDate(e){return new Date(e)}fileChecked(e,i){e.detail.checked?this.selectedAttachments.push(i):this.selectedAttachments.filter(n=>{n.id===i.id&&this.selectedAttachments.splice(this.selectedAttachments.findIndex(c=>c===i),1)})}unmarkAttachments(){this.selectedAttachments=[],this.hideCheckBox=!0,this.attachments=this.deSelectAllAttachments(this.attachments)}deSelectAllAttachments(e){for(let i=0;i<this.attachmentDates.length;i++)e[this.attachmentDates[i]]=e[this.attachmentDates[i]].map(n=>({...n,isSelected:!1}));return e}shareAttachmentToVisit(){let e=[];this.selectedAttachments.map(c=>{let _={entityCode:this.appointment.hospital.code,reportHospitalCode:c.entityCode,contextId:this.appointment.visitId.toString(),contextType:"VISIT",fileName:c.fileName,base64DataURI:"",thumbnailBase64DataURI:c.thumbnailBase64DataURI,description:c.fileName,category:"40210",id:c.id};e.push(_)}),this.httpService.postInBackground("/attachment/resultAttachment/share",{attachmentArray:e},!0).then(c=>{c&&this.router.navigate(["/home/appointment-details"],{state:{appointmentDetails:this.appointment}})}).catch(c=>{this.utilityService.presentAlert("Error!",c.message)})}ngOnDestroy(){this.pageNavService.cleanup()}}return(s=d).\u0275fac=function(e){return new(e||s)(t.rXU(b.OD),t.rXU(b.q9),t.rXU(C.n),t.rXU(o.Ix),t.rXU(h.k),t.rXU(l.hG),t.rXU(m.Q),t.rXU(M.bZ),t.rXU(D.up),t.rXU(E.V))},s.\u0275cmp=t.VBU({type:s,selectors:[["app-report-attachment-list"]],standalone:!0,features:[t.aNF],decls:6,vars:3,consts:[["id","noReports",1,"labelCenter",3,"hidden"],[1,"labelCenter","header","greyText"],["class","bodyText ion-padding-top",4,"ngFor","ngForOf"],["class","ion-no-padding",4,"ngIf"],[1,"bodyText","ion-padding-top"],[1,"ion-no-padding",2,"margin-top","5%","margin-left","6%","margin-right","6%"],[1,"ion-no-padding"],["size","3",1,"ion-no-padding",2,"display","flex!important","align-content","center!important","align-items","center!important","justify-content","center"],["size","9",1,"ion-no-padding",2,"display","flex!important","align-content","center!important","align-items","center!important"],[2,"width","100%","height","1px","background-color","var(--ion-color-secondary)"],["size","4","size-lg","3","size-md","4","size-sm","4","style","margin-top: 2%;",4,"ngFor","ngForOf"],["size","4","size-lg","3","size-md","4","size-sm","4",2,"margin-top","2%"],["color","secondary","id","notifications-badge","mode","ios",3,"ionChange","ngModelChange","hidden","ngModel"],["fill","clear",1,"ion-no-padding","attachment-button",3,"disabled"],[3,"hidden","ngClass"],[3,"click","src"],["align","center",2,"width","100%","height","150px","background-color","#cccccc",3,"click","hidden"],[1,"text-body-md",2,"position","relative","top","50%","padding","10px","border-radius","6px","right","0"],[1,"textShade",2,"height","17px","overflow","hidden","margin-top","10px"],[1,"bodyText"],["align","center",1,"primaryText"],[3,"click",4,"ngIf"],["align","center",1,"greyText"],[3,"click"]],template:function(e,i){1&e&&(t.j41(0,"ion-content")(1,"div",0)(2,"ion-label",1),t.EFF(3,"No reports attached"),t.k0s()(),t.DNE(4,R,13,5,"div",2),t.k0s(),t.DNE(5,A,11,2,"ion-footer",3)),2&e&&(t.R7$(),t.Y8G("hidden",!0),t.R7$(3),t.Y8G("ngForOf",i.attachmentDates),t.R7$(),t.Y8G("ngIf",i.selectedAttachments.length>0))},dependencies:[l.bv,l.Jm,l.eY,l.hU,l.W9,l.M0,l.lO,l.he,l.ln,l.Zx,l.ai,l.hB,p.bT,p.MD,p.YU,p.Sq,p.vh,v.YN,v.BC,v.vS],styles:[".display-full-width[_ngcontent-%COMP%]{width:100%;padding-top:3%}.button-size[_ngcontent-%COMP%]{width:180px;margin-bottom:22px}.profile-icon[_ngcontent-%COMP%]{height:45px;width:45px}.add-attachment-icon[_ngcontent-%COMP%]{width:80px;height:80px}.file-icon[_ngcontent-%COMP%]{zoom:1.3}.secondaryDarkText[_ngcontent-%COMP%], u[_ngcontent-%COMP%]:hover{color:var(--ion-color-secondary-dark)}.time-icon[_ngcontent-%COMP%]{zoom:2.5;color:var(--ion-color-primary-dark)}.align-vertical-center[_ngcontent-%COMP%]{vertical-align:-webkit-baseline-middle}ion-content[_ngcontent-%COMP%]{padding-bottom:20px}ion-card[_ngcontent-%COMP%]{width:auto}.labelCenter[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:45%;transform:translateY(-50%);font-size:var(--font-body-md)}.actionButton[_ngcontent-%COMP%]{color:var(--ion-color-primary-dark);zoom:1.5}.textShade[_ngcontent-%COMP%]{background:-webkit-linear-gradient(left,#333333,#c0bebe);-webkit-text-fill-color:transparent}.thumbnailSize[_ngcontent-%COMP%]{width:100%;height:150px}ion-thumbnail[_ngcontent-%COMP%]{box-shadow:0 0 5px}#notifications-badge[_ngcontent-%COMP%]{position:absolute;right:1%;top:-4px}.gray-border[_ngcontent-%COMP%]{border:3px solid gray}.headerIcon[_ngcontent-%COMP%]{zoom:1.1;vertical-align:sub}.attachment-button[_ngcontent-%COMP%]{height:initial;width:100%}"]}),d})()},8135:(P,y,r)=>{r.d(y,{V:()=>v});var f=r(4438),l=r(600),p=r(9012);let v=(()=>{var t;class b{constructor(o,h){this.platform=o,this.router=h,this.activeSubscriptions=new Map}setupBackButton(o,h){Array.isArray(o)?o.forEach(m=>{this.setupSingleBackButton(m.route,m.handler)}):"string"==typeof o&&h&&this.setupSingleBackButton(o,h)}setupSingleBackButton(o,h){this.cleanupBackButton(o);const m=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===o&&h()});this.activeSubscriptions.set(o,m)}cleanupBackButton(o){const h=this.activeSubscriptions.get(o);h&&(h.unsubscribe(),this.activeSubscriptions.delete(o))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((o,h)=>{o.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(o="/home"){window.history.length>1?window.history.back():this.router.navigate([o])}smartNavigateBack(o){const m={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[o];m?this.router.navigate([m]):this.navigateBack()}}return(t=b).\u0275fac=function(o){return new(o||t)(f.KVO(l.OD),f.KVO(p.Ix))},t.\u0275prov=f.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),b})()}}]);