"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6765],{6765:(y,v,r)=>{r.r(v),r.d(v,{SelectPatientPage:()=>E});var d=r(467),o=r(9893),h=r(177),t=r(4438),u=r(9934),f=r(8023),b=r(9012),a=r(600),s=r(8135),g=r(8875);function M(m,_){1&m&&(t.j41(0,"div",25)(1,"ion-badge",26),t.EFF(2," Auto-selected from global family member "),t.k0s()())}function S(m,_){if(1&m){const l=t.RV6();t.j41(0,"ion-item",18)(1,"ion-grid",19),t.bIt("click",function(){const i=t.eBV(l).$implicit,n=t.XpG();return t.Njj(n.checkMapping(i,"modify"))}),t.j41(2,"ion-row")(3,"ion-col",20)(4,"ion-avatar"),t.nrm(5,"img",21),t.k0s()(),t.j41(6,"ion-col",22)(7,"ion-row")(8,"ion-col",18)(9,"strong"),t.EFF(10),t.k0s()()(),t.j41(11,"ion-row",23)(12,"ion-col",18)(13,"strong"),t.EFF(14),t.nI1(15,"date"),t.k0s(),t.DNE(16,M,3,0,"div",24),t.k0s()()()()()()}if(2&m){const l=_.$implicit,e=t.XpG();t.R7$(),t.xc7("border",e.isPatientAutoSelected(l)?"2px solid var(--primary-main)":"none")("border-radius",e.isPatientAutoSelected(l)?"8px":"0")("background-color",e.isPatientAutoSelected(l)?"rgba(var(--primary-main-rgb), 0.1)":"transparent"),t.Y8G("ngClass",e.getPatientDisplayClass(l)),t.R7$(9),t.SpI(" ",l.patientName," "),t.R7$(4),t.SpI(" DOB: ",t.i5U(15,10,l.dob,"dd MMM yyyy")," "),t.R7$(2),t.Y8G("ngIf",e.isPatientAutoSelected(l))}}let E=(()=>{var m;class _{constructor(e,i,n,p,c,P,k){this.utilityService=e,this.httpService=i,this.router=n,this.navCtrl=p,this.platform=c,this.pageNavService=P,this.globalFamilyMemberService=k,this.accountInfo=[],this.selectedGlobalFamilyMember=null,this.autoSelectedPatient=null}ngOnInit(){this.selectedGlobalFamilyMember=this.globalFamilyMemberService.getSelectedMember()}ionViewWillEnter(){this.pageNavService.setupBackButton("/select-patient",()=>{this.router.navigate(["appointment-booking"])})}selectedMember(e){}goToAppointment(e,i){this.router.navigate(["/home/appointment-booking"],{queryParams:{mrn:e,navigateFrom:i}})}checkMapping(e,i){var n=this;return(0,d.A)(function*(){n.selectedGlobalFamilyMember&&e&&n.isPatientMatchingGlobalMember(e)&&(n.autoSelectedPatient=e);const p="/familyMemberHospitalAccount/?familyMemberId="+n.familyMemberId+"&hospitalCode="+n.hospitalCode;yield n.httpService.getInBackground(p,!0).then(c=>{c.length>0&&(e?"modify"===i?n.editPatientMap(e,c[0]._id):n.deletePatientMap():"modify"===i?n.mapToHospital(e):n.goToAppointment(null,"fromLinkPatient"))}).catch(c=>{n.utilityService.presentAlert("Error!",c.message)})})()}isPatientMatchingGlobalMember(e){var i,n;return!(!this.selectedGlobalFamilyMember||!e)&&(null===(i=e.patientName)||void 0===i?void 0:i.toLowerCase().trim())===(null===(n=this.selectedGlobalFamilyMember.fullName)||void 0===n?void 0:n.toLowerCase().trim())}isPatientAutoSelected(e){return this.autoSelectedPatient===e}getPatientDisplayClass(e){return this.isPatientAutoSelected(e)?"auto-selected-patient":this.familyMemberName!==e.patientName?"disabledText":""}editPatientMap(e,i){var n=this;return(0,d.A)(function*(){const p="/familyMemberHospitalAccount/"+i,c={mrn:e.mrn,patientId:e.id};yield n.httpService.put(p,c).then(P=>{n.goToAppointment(e.mrn,"fromLinkPatient"),n.utilityService.presentToast("Patient Updated",2e3)}).catch(P=>{n.utilityService.presentAlert("Error!",P.message)})})()}deletePatientMap(){var e=this;return(0,d.A)(function*(){const i="/familyMemberHospitalAccount/?familyMemberId="+e.familyMemberId+"&hospitalCode="+e.hospitalCode;yield e.httpService.getInBackground(i,!0).then(n=>{e.goToAppointment(null,"fromLinkPatient"),e.utilityService.presentToast("Patient Deleted",2e3)}).catch(n=>{e.utilityService.presentAlert("Error!",n.message)})})()}mapToHospital(e){var i=this;return(0,d.A)(function*(){const n={mrn:e.mrn,patientId:e.id,familyMemberId:i.familyMemberId,userId:i.userId,hospitalId:i.hospitalId,hospitalCode:i.hospitalCode,hospitalName:i.hospitalName};yield i.httpService.postInBackground("/familyMemberHospitalAccount",n,!0,!0).then(p=>{i.goToAppointment(e.mrn,"fromLinkPatient"),i.utilityService.presentToast("Patient Mapped",2e3)}).catch(p=>{i.utilityService.presentAlert("Error!",p.message)})})()}ngOnDestroy(){this.pageNavService.cleanupBackButton("/select-patient")}}return(m=_).\u0275fac=function(e){return new(e||m)(t.rXU(u.Q),t.rXU(f.k),t.rXU(b.Ix),t.rXU(a.q9),t.rXU(a.OD),t.rXU(s.V),t.rXU(g.b))},m.\u0275cmp=t.VBU({type:m,selectors:[["app-select-patient"]],standalone:!0,features:[t.aNF],decls:26,vars:3,consts:[[1,"primaryDark"],["slot","start"],["text","","icon","chevron-back-outline",3,"click"],[1,"titleHeader"],[1,"titleText"],["margin-top","",1,"ion-no-padding"],["size","2",1,"ion-no-padding"],["margin-start","",1,"hospital-icon"],["src","assets/icon/hospitalIconOutline.png"],["size","10"],[1,"bodyText",2,"vertical-align","-webkit-baseline-middle"],[1,"bodyText"],[1,"bodyText","greyText"],["lines","none",1,"ion-no-padding"],["class","ion-no-padding",4,"ngFor","ngForOf"],["padding-top","","no-border","","align","center"],["margin-bottom","","translucent","",2,"color","var(--primary-main)",3,"click"],[2,"color","#fff"],[1,"ion-no-padding"],[1,"ion-no-padding","bodyText",3,"click","ngClass"],["size","3","align","center"],["src","assets/icon/maleProfileIcon.png",1,"profile-icon"],["size","9"],[1,"ion-no-padding","row-spacing"],["style","margin-top: 4px;",4,"ngIf"],[2,"margin-top","4px"],["color","primary",2,"font-size","10px"]],template:function(e,i){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-back-button",2),t.bIt("click",function(){return i.goToAppointment(i.selectedPatientMrn,"fromLinkPatient")}),t.k0s()(),t.j41(4,"ion-title",3)(5,"ion-text",4),t.EFF(6,"Link Patient"),t.k0s()()()(),t.j41(7,"ion-content")(8,"ion-row",5)(9,"ion-col",6)(10,"ion-avatar",7),t.nrm(11,"img",8),t.k0s()(),t.j41(12,"ion-col",9)(13,"span",10),t.EFF(14),t.k0s()()(),t.j41(15,"p",11),t.EFF(16),t.k0s(),t.j41(17,"span",12),t.EFF(18,"Select and Confirm"),t.k0s(),t.j41(19,"ion-list",13),t.DNE(20,S,17,13,"ion-item",14),t.k0s(),t.nrm(21,"br"),t.k0s(),t.j41(22,"ion-footer",15)(23,"ion-button",16),t.bIt("click",function(){return i.checkMapping(null,"delete")}),t.j41(24,"span",17),t.EFF(25,"New Patient"),t.k0s()()()),2&e&&(t.R7$(14),t.JRh(i.hospitalName),t.R7$(2),t.SpI("Patients registered with ph. no: ",i.phone,""),t.R7$(4),t.Y8G("ngForOf",i.accountInfo))},dependencies:[o.bv,o.mC,o.In,o.Jm,o.QW,o.hU,o.W9,o.M0,o.lO,o.eU,o.uz,o.nf,o.ln,o.IO,o.BC,o.ai,o.el,h.pM,h.MD,h.YU,h.bT,h.vh],styles:["*[_ngcontent-%COMP%]{padding:0;margin-top:2%}.display-full-width[_ngcontent-%COMP%]{width:100%;padding:var(--mc-spacing-lg)}  .custom-dialog-container .mat-dialog-container{padding:0!important;overflow-x:hidden;box-sizing:border-box}mat-dialog-content[_ngcontent-%COMP%]{padding-left:var(--mc-spacing-xl);padding-right:var(--mc-spacing-xl);color:var(--mc-text-primary)}.feature[_ngcontent-%COMP%]{width:250px;border-radius:var(--mc-radius-sm)}p[_ngcontent-%COMP%]{text-align:left;margin-left:var(--mc-spacing-md)}.greyText[_ngcontent-%COMP%]{margin-left:var(--mc-spacing-md)}.row-spacing[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-sm)}.disabledText[_ngcontent-%COMP%]{color:var(--mc-text-tertiary)}.auto-selected-patient[_ngcontent-%COMP%]{color:var(--mc-color-primary-500);font-weight:var(--mc-font-weight-semibold)}ion-avatar[_ngcontent-%COMP%]{width:38px;height:40px}.hospital-icon[_ngcontent-%COMP%]{width:35px;height:35px}.profile-icon[_ngcontent-%COMP%]{margin-left:var(--mc-spacing-md)}ion-grid[_ngcontent-%COMP%]{text-align:left;border:1px solid var(--mc-border-primary);padding-top:var(--mc-spacing-sm);padding-bottom:var(--mc-spacing-sm)}ion-item[_ngcontent-%COMP%]{margin-left:var(--mc-spacing-md);margin-top:var(--mc-spacing-md);cursor:pointer}.button-size[_ngcontent-%COMP%]{width:180px;margin-bottom:var(--mc-spacing-xl)}"]}),_})()},8135:(y,v,r)=>{r.d(v,{V:()=>t});var d=r(4438),o=r(600),h=r(9012);let t=(()=>{var u;class f{constructor(a,s){this.platform=a,this.router=s,this.activeSubscriptions=new Map}setupBackButton(a,s){Array.isArray(a)?a.forEach(g=>{this.setupSingleBackButton(g.route,g.handler)}):"string"==typeof a&&s&&this.setupSingleBackButton(a,s)}setupSingleBackButton(a,s){this.cleanupBackButton(a);const g=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===a&&s()});this.activeSubscriptions.set(a,g)}cleanupBackButton(a){const s=this.activeSubscriptions.get(a);s&&(s.unsubscribe(),this.activeSubscriptions.delete(a))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((a,s)=>{a.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(a="/home"){window.history.length>1?window.history.back():this.router.navigate([a])}smartNavigateBack(a){const g={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[a];g?this.router.navigate([g]):this.navigateBack()}}return(u=f).\u0275fac=function(a){return new(a||u)(d.KVO(o.OD),d.KVO(h.Ix))},u.\u0275prov=d.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),f})()}}]);