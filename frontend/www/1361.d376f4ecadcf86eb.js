"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1361],{1361:(F,O,l)=>{l.r(O),l.d(O,{PrescriptionVisitDetailPage:()=>Z});var x=l(467),p=l(9893),h=l(177),D=l(8176),v=l(2739),y=l(5083),M=l(4726),t=l(4438);let u=(()=>{var i;class s{}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.VBU({type:i,selectors:[["rx-summary-card"]],inputs:{summary:"summary"},standalone:!0,features:[t.aNF],decls:16,vars:5,consts:[[1,"summary"],[1,"summary-sub"],[1,"meta"],[1,"chip"]],template:function(n,e){1&n&&(t.j41(0,"section",0)(1,"div")(2,"h1"),t.EFF(3,"Prescription Details"),t.k0s(),t.j41(4,"div",1),t.EFF(5,"Signed by "),t.j41(6,"strong"),t.EFF(7),t.k0s(),t.EFF(8),t.k0s(),t.j41(9,"div",2)(10,"span",3),t.EFF(11),t.k0s(),t.j41(12,"span",3),t.EFF(13),t.k0s(),t.j41(14,"span",3),t.EFF(15,"SIGNED"),t.k0s()()()()),2&n&&(t.R7$(7),t.JRh(e.summary.doctor),t.R7$(),t.SpI(" \xb7 ",e.summary.date,""),t.R7$(3),t.Lme("",e.summary.itemsCount," ",1===e.summary.itemsCount?"item":"items",""),t.R7$(2),t.JRh(e.summary.sheet))},dependencies:[h.MD,p.bv],styles:['.summary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f0f9ff,#e0f2fe,#dbeafe);border:1px solid var(--mc-color-primary-200);border-radius:var(--mc-radius-lg);padding:var(--mc-spacing-md);box-shadow:0 2px 8px #00258214;margin:0 0 var(--mc-spacing-lg);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out;transition:all var(--mc-transition-base);position:relative;overflow:hidden}.summary[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;right:0;width:100px;height:100px;background:radial-gradient(circle at top right,rgba(0,37,130,.05),transparent);pointer-events:none}.summary[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0025821f;transform:translateY(-1px)}.summary[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg);margin:0 0 var(--mc-spacing-xs);letter-spacing:-.01em;color:var(--mc-text-primary);font-weight:600;line-height:1.3}@media (max-width: 600px){.summary[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-md)}}.summary[_ngcontent-%COMP%]   .summary-sub[_ngcontent-%COMP%]{color:var(--mc-text-secondary);font-size:var(--mc-font-body-sm);margin-top:var(--mc-spacing-xs);line-height:1.5}.summary[_ngcontent-%COMP%]   .summary-sub[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--mc-text-primary);font-weight:600}.summary[_ngcontent-%COMP%]   .meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:var(--mc-spacing-xs) var(--mc-spacing-sm);margin-top:var(--mc-spacing-sm)}.summary[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]{font-size:10px;padding:4px var(--mc-spacing-sm);border-radius:var(--mc-radius-full);background:linear-gradient(135deg,#fff,#f0f9ff);color:var(--mc-color-primary-700);border:1px solid var(--mc-color-primary-300);font-weight:600;text-transform:uppercase;letter-spacing:.3px;white-space:nowrap;box-shadow:0 1px 2px #00258214;transition:all var(--mc-transition-base)}.summary[_ngcontent-%COMP%]   .chip[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#fff,#dbeafe);transform:translateY(-1px);box-shadow:0 2px 4px #0025821f}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']}),s})();function _(i,s){if(1&i&&(t.j41(0,"div",7)(1,"span",8),t.EFF(2,"Quantity"),t.k0s(),t.j41(3,"span",9),t.EFF(4),t.k0s()()),2&i){const a=t.XpG();t.R7$(4),t.JRh(a.item.qty)}}function R(i,s){if(1&i&&(t.j41(0,"div",7)(1,"span",8),t.EFF(2,"Route"),t.k0s(),t.j41(3,"span",12),t.nrm(4,"ion-icon",13),t.EFF(5),t.k0s()()),2&i){const a=t.XpG();t.R7$(5),t.SpI(" ",a.item.route," ")}}function E(i,s){if(1&i&&(t.j41(0,"div",7)(1,"span",8),t.EFF(2,"Time"),t.k0s(),t.j41(3,"span",14),t.nrm(4,"ion-icon",15),t.EFF(5),t.k0s()()),2&i){const a=t.XpG();t.R7$(5),t.SpI(" ",a.item.timeOfDay," ")}}function I(i,s){if(1&i&&(t.j41(0,"div",16),t.nrm(1,"ion-icon",17),t.j41(2,"span",18),t.EFF(3),t.k0s()()),2&i){const a=t.XpG();t.R7$(3),t.JRh(a.item.remarks)}}let T=(()=>{var i;class s{}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.VBU({type:i,selectors:[["rx-item-card"]],inputs:{item:"item"},standalone:!0,features:[t.aNF],decls:28,vars:12,consts:[[1,"rx-card",3,"ngClass"],[1,"status-pill",3,"ngClass"],[1,"rx-content"],[1,"rx-header"],[1,"rx-name"],[1,"status-badge",3,"ngClass"],[1,"rx-details"],[1,"detail-item"],[1,"detail-label"],[1,"detail-value"],["class","detail-item",4,"ngIf"],["class","rx-remarks",4,"ngIf"],[1,"detail-value","route-value"],["name","medical-outline"],[1,"detail-value","time-value"],["name","time-outline"],[1,"rx-remarks"],["name","information-circle-outline",1,"remarks-icon"],[1,"remarks-text"]],template:function(n,e){1&n&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2)(3,"div",3)(4,"h3",4),t.EFF(5),t.k0s(),t.j41(6,"span",5),t.EFF(7),t.k0s()(),t.j41(8,"div",6)(9,"div",7)(10,"span",8),t.EFF(11,"Dosage"),t.k0s(),t.j41(12,"span",9),t.EFF(13),t.k0s()(),t.j41(14,"div",7)(15,"span",8),t.EFF(16,"How to take"),t.k0s(),t.j41(17,"span",9),t.EFF(18),t.k0s()(),t.j41(19,"div",7)(20,"span",8),t.EFF(21,"Duration"),t.k0s(),t.j41(22,"span",9),t.EFF(23),t.k0s()(),t.DNE(24,_,5,1,"div",10)(25,R,6,1,"div",10)(26,E,6,1,"div",10),t.k0s(),t.DNE(27,I,4,1,"div",11),t.k0s()()),2&n&&(t.Y8G("ngClass","status-"+e.item.status),t.R7$(),t.Y8G("ngClass",e.item.status),t.R7$(4),t.JRh(e.item.name),t.R7$(),t.Y8G("ngClass",e.item.status),t.R7$(),t.SpI(" ","active"===e.item.status?"Active":"Expired"," "),t.R7$(6),t.JRh(e.item.dose),t.R7$(5),t.JRh(e.item.frequency),t.R7$(5),t.JRh(e.item.durationText),t.R7$(),t.Y8G("ngIf",e.item.qty),t.R7$(),t.Y8G("ngIf",e.item.route),t.R7$(),t.Y8G("ngIf",e.item.timeOfDay),t.R7$(),t.Y8G("ngIf",e.item.remarks))},dependencies:[h.MD,h.YU,h.bT,p.bv,p.iq],styles:["[_nghost-%COMP%]{display:block;margin-bottom:var(--mc-spacing-sm)}.rx-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8faff);border:1px solid var(--mc-card-border);border-radius:var(--mc-radius-lg);box-shadow:var(--mc-shadow-sm);overflow:hidden;transition:all var(--mc-transition-base);position:relative}.rx-card[_ngcontent-%COMP%]:hover{box-shadow:var(--mc-shadow-md);transform:translateY(-1px);border-color:var(--mc-color-primary-200);background:linear-gradient(135deg,#fff,#f0f5ff)}.rx-card[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:var(--mc-shadow-sm)}.rx-card.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f6fff8,#f0fdf4);border-color:var(--mc-color-success-200)}.rx-card.status-active[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f0fdf4,#dcfce7)}.rx-card.status-expired[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fafafa,#f5f5f5);border-color:var(--mc-color-gray-300);opacity:.9}.rx-card.status-expired[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f5f5f5,#f0f0f0)}.status-pill[_ngcontent-%COMP%]{position:absolute;left:0;top:0;bottom:0;width:4px;background:linear-gradient(180deg,var(--mc-color-gray-300),var(--mc-color-gray-400));transition:all var(--mc-transition-base)}.status-pill.active[_ngcontent-%COMP%]{background:linear-gradient(180deg,var(--mc-color-success-400),var(--mc-color-success-600));box-shadow:0 0 8px #22c55e4d}.status-pill.expired[_ngcontent-%COMP%]{background:linear-gradient(180deg,var(--mc-color-gray-300),var(--mc-color-gray-500))}.rx-content[_ngcontent-%COMP%]{padding:var(--mc-spacing-md);padding-left:calc(var(--mc-spacing-md) + 8px)}.rx-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;gap:var(--mc-spacing-sm);margin-bottom:var(--mc-spacing-sm);padding-bottom:var(--mc-spacing-sm);border-bottom:1px solid rgba(0,37,130,.06)}.status-active[_ngcontent-%COMP%]   .rx-header[_ngcontent-%COMP%]{border-bottom-color:#22c55e14}.status-expired[_ngcontent-%COMP%]   .rx-header[_ngcontent-%COMP%]{border-bottom-color:#0000000d}.rx-name[_ngcontent-%COMP%]{flex:1;font-size:var(--mc-font-body-lg);font-weight:600;color:var(--mc-text-primary);margin:0;line-height:1.3;letter-spacing:-.01em}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:3px var(--mc-spacing-sm);border-radius:var(--mc-radius-sm);font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;flex-shrink:0;line-height:1.2;box-shadow:0 1px 2px #0000000d}.status-badge.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0);color:var(--mc-color-success-800);border:1px solid var(--mc-color-success-300)}.status-badge.expired[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3f4f6,#e5e7eb);color:var(--mc-color-gray-700);border:1px solid var(--mc-color-gray-400)}.rx-details[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:var(--mc-spacing-sm) var(--mc-spacing-md)}@media (max-width: 600px){.rx-details[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:var(--mc-spacing-sm)}}@media (max-width: 480px){.rx-details[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:calc(var(--mc-spacing-xs) * 1.5)}}@media (max-width: 380px){.rx-details[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:var(--mc-spacing-xs)}}@media (max-width: 320px){.rx-details[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:calc(var(--mc-spacing-xs) * .8)}}@media (max-width: 280px){.rx-details[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:calc(var(--mc-spacing-xs) * .6)}}.detail-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:3px;padding:var(--mc-spacing-xs);background:#ffffff80;border-radius:var(--mc-radius-sm);border:1px solid rgba(0,37,130,.04);transition:all var(--mc-transition-base)}.detail-item[_ngcontent-%COMP%]:hover{background:#fffc;border-color:#00258214}.status-active[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{background:#f0fdf466;border-color:#22c55e14}.status-active[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:hover{background:#dcfce799;border-color:#22c55e26}.status-expired[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{background:#f9fafb80;border-color:#0000000a}.status-expired[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:hover{background:#f3f4f6cc}.detail-label[_ngcontent-%COMP%]{font-size:10px;font-weight:600;color:var(--mc-text-tertiary);text-transform:uppercase;letter-spacing:.5px;line-height:1.2}.detail-value[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm);font-weight:600;color:var(--mc-text-primary);line-height:1.4}.detail-value.time-value[_ngcontent-%COMP%], .detail-value.route-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.detail-value.time-value[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .detail-value.route-value[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px;color:var(--mc-color-primary-500);flex-shrink:0}.rx-remarks[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-sm);padding:var(--mc-spacing-sm);background:linear-gradient(135deg,#fef3c7,#fde68a);border:1px solid #fbbf24;border-left:3px solid #f59e0b;border-radius:var(--mc-radius-sm);display:flex;align-items:flex-start;gap:var(--mc-spacing-xs);box-shadow:0 1px 3px #f59e0b1a}.rx-remarks[_ngcontent-%COMP%]   .remarks-icon[_ngcontent-%COMP%]{font-size:18px;color:#f59e0b;flex-shrink:0;margin-top:1px}.rx-remarks[_ngcontent-%COMP%]   .remarks-text[_ngcontent-%COMP%]{flex:1;font-size:var(--mc-font-body-sm);font-weight:600;color:#78350f;line-height:1.4}.status-active[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-color:#60a5fa;border-left-color:#3b82f6;box-shadow:0 1px 3px #3b82f61a}.status-active[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]   .remarks-icon[_ngcontent-%COMP%]{color:#3b82f6}.status-active[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]   .remarks-text[_ngcontent-%COMP%]{color:#1e3a8a}.status-expired[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-color:#d1d5db;border-left-color:#9ca3af;box-shadow:0 1px 3px #9ca3af1a;opacity:.8}.status-expired[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]   .remarks-icon[_ngcontent-%COMP%]{color:#6b7280}.status-expired[_ngcontent-%COMP%]   .rx-remarks[_ngcontent-%COMP%]   .remarks-text[_ngcontent-%COMP%]{color:#374151}@media (max-width: 600px){.rx-content[_ngcontent-%COMP%]{padding:var(--mc-spacing-sm);padding-left:calc(var(--mc-spacing-sm) + 8px)}.rx-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--mc-spacing-xs);margin-bottom:var(--mc-spacing-xs);padding-bottom:var(--mc-spacing-xs)}.rx-name[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md)}.status-badge[_ngcontent-%COMP%]{font-size:9px;padding:2px 6px}.detail-label[_ngcontent-%COMP%]{font-size:10px}.detail-value[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm)}.rx-remarks[_ngcontent-%COMP%]{padding:var(--mc-spacing-xs);margin-top:var(--mc-spacing-xs)}.rx-remarks[_ngcontent-%COMP%]   .remarks-icon[_ngcontent-%COMP%]{font-size:16px}.rx-remarks[_ngcontent-%COMP%]   .remarks-text[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm)}}.rx-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out both}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}"]}),s})(),$=(()=>{var i;class s{constructor(){this.view=new t.bkB,this.download=new t.bkB}onView(n){n.stopPropagation(),this.view.emit(this.doc)}onDownload(n){n.stopPropagation(),this.download.emit(this.doc)}}return(i=s).\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.VBU({type:i,selectors:[["rx-document-card"]],inputs:{doc:"doc"},outputs:{view:"view",download:"download"},standalone:!0,features:[t.aNF],decls:14,vars:1,consts:[[1,"card"],["name","document-text","aria-hidden","true",1,"doc-icon"],[1,"card-content"],[1,"title"],[1,"meta"],[1,"actions"],["size","small","fill","solid",1,"btn-primary",3,"click"],["name","eye-outline","slot","start"],["size","small","fill","outline",3,"click"],["name","download-outline","slot","start"]],template:function(n,e){1&n&&(t.j41(0,"article",0),t.nrm(1,"ion-icon",1),t.j41(2,"div",2)(3,"h3",3),t.EFF(4),t.k0s(),t.j41(5,"div",4),t.EFF(6,"Prescription Document"),t.k0s()(),t.j41(7,"div",5)(8,"ion-button",6),t.bIt("click",function(o){return e.onView(o)}),t.nrm(9,"ion-icon",7),t.EFF(10," View "),t.k0s(),t.j41(11,"ion-button",8),t.bIt("click",function(o){return e.onDownload(o)}),t.nrm(12,"ion-icon",9),t.EFF(13," Download "),t.k0s()()()),2&n&&(t.R7$(4),t.JRh(e.doc.displayName))},dependencies:[h.MD,p.bv,p.Jm,p.iq],styles:[".card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fefce8,#fef3c7);border:1px solid var(--mc-color-warning-200);border-radius:var(--mc-radius-md);box-shadow:0 1px 3px #eab3081a;padding:var(--mc-spacing-sm) var(--mc-spacing-md);display:flex;align-items:center;gap:var(--mc-spacing-sm);margin-bottom:var(--mc-spacing-sm);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out;transition:all var(--mc-transition-base)}.card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #eab30826;transform:translateY(-1px);border-color:var(--mc-color-warning-300);background:linear-gradient(135deg,#fef3c7,#fde68a)}.card[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 1px 3px #eab3081a}.doc-icon[_ngcontent-%COMP%]{font-size:28px;color:var(--mc-color-warning-600);flex-shrink:0;filter:drop-shadow(0 1px 2px rgba(234,179,8,.2))}.card-content[_ngcontent-%COMP%]{flex:1;min-width:0}.title[_ngcontent-%COMP%]{font-weight:600;margin:0 0 2px;letter-spacing:-.01em;color:var(--mc-text-primary);font-size:var(--mc-font-body-md);line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.meta[_ngcontent-%COMP%]{color:var(--mc-text-secondary);font-size:var(--mc-font-body-xs);margin:0;line-height:1.4}.actions[_ngcontent-%COMP%]{display:flex;gap:var(--mc-spacing-xs);flex-shrink:0}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: var(--mc-spacing-sm);--padding-end: var(--mc-spacing-sm);--border-radius: var(--mc-radius-sm);margin:0;font-size:11px;font-weight:600;text-transform:none;letter-spacing:.3px}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:14px;margin-right:2px}.actions[_ngcontent-%COMP%]   ion-button.btn-primary[_ngcontent-%COMP%]{--background: var(--mc-color-primary-500);--background-hover: var(--mc-color-primary-600);--background-activated: var(--mc-color-primary-700)}@media (max-width: 600px){.card[_ngcontent-%COMP%]{flex-wrap:wrap;padding:var(--mc-spacing-sm)}.doc-icon[_ngcontent-%COMP%]{font-size:24px}.card-content[_ngcontent-%COMP%]{flex:1 1 auto}.actions[_ngcontent-%COMP%]{flex-basis:100%;justify-content:flex-end;margin-top:var(--mc-spacing-xs);gap:var(--mc-spacing-xs)}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-size:10px}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:12px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]}),s})();var S=l(9012),j=l(8023),N=l(600),V=l(8251),Y=l(8135);function G(i,s){1&i&&(t.j41(0,"div",3),t.nrm(1,"ion-spinner",4),t.j41(2,"p",5),t.EFF(3,"Loading prescriptions..."),t.k0s()())}function z(i,s){if(1&i&&t.nrm(0,"rx-summary-card",15),2&i){const a=t.XpG(2);t.Y8G("summary",a.summary)}}function A(i,s){if(1&i){const a=t.RV6();t.j41(0,"section",16),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.toggleActiveSection())}),t.j41(1,"h2"),t.EFF(2,"Active Prescriptions"),t.k0s(),t.j41(3,"div",17)(4,"span",18),t.EFF(5),t.k0s(),t.nrm(6,"ion-icon",19),t.k0s()()}if(2&i){const a=t.XpG(2);t.AVh("section-open",a.isActiveSectionOpen),t.R7$(5),t.JRh(a.active.length)}}function B(i,s){1&i&&t.nrm(0,"rx-item-card",22),2&i&&t.Y8G("item",s.$implicit)}function U(i,s){if(1&i&&(t.j41(0,"div",20),t.DNE(1,B,1,1,"rx-item-card",21),t.k0s()),2&i){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.active)}}function X(i,s){if(1&i){const a=t.RV6();t.j41(0,"section",23),t.bIt("click",function(){t.eBV(a);const e=t.XpG(2);return t.Njj(e.toggleExpiredSection())}),t.j41(1,"h2"),t.EFF(2,"Expired"),t.k0s(),t.j41(3,"div",17),t.nrm(4,"ion-icon",19),t.k0s()()}if(2&i){const a=t.XpG(2);t.AVh("section-open",a.isExpiredSectionOpen)}}function L(i,s){1&i&&t.nrm(0,"rx-item-card",22),2&i&&t.Y8G("item",s.$implicit)}function J(i,s){if(1&i&&(t.j41(0,"div",24),t.DNE(1,L,1,1,"rx-item-card",21),t.k0s()),2&i){const a=t.XpG(2);t.R7$(),t.Y8G("ngForOf",a.expired)}}function W(i,s){if(1&i&&(t.j41(0,"section",25)(1,"h2"),t.EFF(2,"Prescription Documents"),t.k0s(),t.j41(3,"span",18),t.EFF(4),t.k0s()()),2&i){const a=t.XpG(2);t.R7$(4),t.JRh(a.prescriptionPrintDocuments.length)}}function K(i,s){if(1&i){const a=t.RV6();t.j41(0,"rx-document-card",26),t.bIt("view",function(e){t.eBV(a);const r=t.XpG(2);return t.Njj(r.viewPDF(e))})("download",function(e){t.eBV(a);const r=t.XpG(2);return t.Njj(r.downloadPDF(e))}),t.k0s()}2&i&&t.Y8G("doc",s.$implicit)}function H(i,s){1&i&&(t.j41(0,"div",27),t.nrm(1,"ion-icon",28),t.j41(2,"p"),t.EFF(3,"No prescriptions available for this visit"),t.k0s(),t.j41(4,"p",29),t.EFF(5,"Check back later or contact your healthcare provider"),t.k0s()())}function Q(i,s){if(1&i&&(t.j41(0,"main",6),t.DNE(1,z,1,1,"rx-summary-card",7)(2,A,7,3,"section",8)(3,U,2,1,"div",9)(4,X,5,2,"section",10)(5,J,2,1,"div",11)(6,W,5,1,"section",12)(7,K,1,1,"rx-document-card",13)(8,H,6,0,"div",14),t.k0s()),2&i){const a=t.XpG();t.R7$(),t.Y8G("ngIf",a.prescriptionDocuments.length>0||a.prescriptionPrintDocuments.length>0),t.R7$(),t.Y8G("ngIf",a.active.length>0),t.R7$(),t.Y8G("ngIf",a.isActiveSectionOpen),t.R7$(),t.Y8G("ngIf",a.expired.length>0),t.R7$(),t.Y8G("ngIf",a.isExpiredSectionOpen),t.R7$(),t.Y8G("ngIf",a.prescriptionPrintDocuments.length>0),t.R7$(),t.Y8G("ngForOf",a.prescriptionPrintDocuments),t.R7$(),t.Y8G("ngIf",0===a.active.length&&0===a.expired.length&&0===a.prescriptionPrintDocuments.length)}}let Z=(()=>{var i;class s{constructor(n,e,r,o,m,c,d,f){var P,w,b,C,k;this.router=n,this.httpService=e,this.loadingController=r,this.navService=o,this.platform=m,this.toastController=c,this.pageNavService=d,this.modalController=f,this.isLoading=!0,this.prescriptionPrintDocuments=[],this.summaryData=null,this.prescriptionDocuments=[],this.showPrescriptionDetails=!0,this.summary={doctor:"",date:"",itemsCount:0,sheet:""},this.active=[],this.expired=[],this.isExpiredSectionOpen=!1,this.isActiveSectionOpen=!1,this.navService.pageChange("Prescription Details");const g=this.router.getCurrentNavigation();this.visitId=null==g||null===(P=g.extras.state)||void 0===P?void 0:P.visitId,this.hospitalCode=null==g||null===(w=g.extras.state)||void 0===w?void 0:w.hospitalCode,this.patientId=null==g||null===(b=g.extras.state)||void 0===b?void 0:b.patientId,this.visitType=null==g||null===(C=g.extras.state)||void 0===C?void 0:C.visitType,this.familyMemberId=null==g||null===(k=g.extras.state)||void 0===k?void 0:k.familyMemberId}ngOnInit(){}ionViewWillEnter(){var n=this;return(0,x.A)(function*(){n.navService.pageChange("Prescription Details"),n.visitId&&n.hospitalCode&&(yield n.getPrescriptionOnly(n.visitId,n.hospitalCode,n.familyMemberId)),n.pageNavService.setupBackButton([{route:"/prescription-visit-detail",handler:()=>n.router.navigate(["/home/prescription-visits"])}])})()}getPrescriptionOnly(n,e,r){var o=this;return(0,x.A)(function*(){o.isLoading=!0;const m=`/emr/visit-summary?hospitalCode=${e}&visitRID=${n}&selectedFamilyMemberId=${r}&fetchPrescriptionOnly=true`;try{const c=yield o.httpService.get(m);o.summaryData=c,o.prescriptionPrintDocuments=c.prescriptionPrint||[],o.prescriptionDocuments=c.prescriptionDocumentArr||[],o.processPrescriptionData(),0===o.prescriptionPrintDocuments.length&&0===o.prescriptionDocuments.length&&o.showToast("No prescriptions found for this visit","warning")}catch(c){console.error("Failed to fetch prescriptions",c),o.showToast("Failed to load prescriptions","danger"),o.prescriptionPrintDocuments=[],o.prescriptionDocuments=[]}finally{o.isLoading=!1}})()}processPrescriptionData(){if(this.active=[],this.expired=[],this.prescriptionDocuments.length>0){const e=this.prescriptionDocuments[0];this.summary.doctor=e.signedByName||"Unknown Doctor",this.summary.date=this.formatDate(e.signedDateTime||e.recordedDateTime),this.summary.sheet=e.templateName||"Generic Case Sheet"}this.prescriptionDocuments.forEach((e,r)=>{this.getPrescriptionSections(e).forEach(m=>{m.patientData&&m.patientData.length>0&&m.patientData.forEach((c,d)=>{const f={id:`rx-${r}-${d}`,name:c.drugName,dose:c.dosageDescription||c.dosageText||"N/A",frequency:this.getPatientFriendlyFrequency(c),durationText:this.getDurationText(c.duration,c.durationUnit),qty:c.totalQty?`${c.totalQty} ${c.uomDescription||"units"}`:void 0,route:c.routeDescription||void 0,timeOfDay:this.getTimeOfDay(c.dosageText),remarks:c.remarks||void 0,status:this.isDrugActive(c)?"active":"expired"};"active"===f.status?this.active.push(f):(f.durationText=c.endDateTime?`Ended ${this.formatDate(c.endDateTime)}`:"Expired",this.expired.push(f))})})}),this.summary.itemsCount=this.active.length+this.expired.length,this.active.length>0&&(this.isActiveSectionOpen=!0)}toggleActiveSection(){this.isActiveSectionOpen=!this.isActiveSectionOpen}getPatientFriendlyFrequency(n){if(n.dosageText&&n.dosageText.trim())return n.dosageText;if(n.dosageDescription&&n.dosageDescription.trim())return n.dosageDescription;if(n.frequency&&n.frequency>0){const e=n.frequency;return 1===e?"Once daily":2===e?"Twice daily":3===e?"Three times daily":`${e} times per day`}return"As needed"}getTimeOfDay(n){if(!n)return;const e=n.toLowerCase();return e.includes("morning")||e.includes("breakfast")?"Morning":e.includes("evening")||e.includes("dinner")?"Evening":e.includes("night")||e.includes("bedtime")||e.includes("hs")?"Night":void 0}viewPDF(n){var e=this;return(0,x.A)(function*(){try{if(y.Ii.isNativePlatform()){yield(yield e.toastController.create({message:"Opening document...",duration:1500,position:"bottom",color:"primary"})).present();let m=n.base64String;m.startsWith("data:")&&(m=m.split(",")[1]);const c=`${n.displayName}_preview.pdf`,d=yield v.YA.writeFile({path:c,data:m,directory:v.__.Cache,recursive:!0});console.log("Temp file created:",d.uri),yield M.M.open({filePath:d.uri,contentType:"application/pdf",openWithDefault:!0})}else yield(yield e.modalController.create({component:D.z,componentProps:{pdfData:n.base64String,documentName:n.displayName},cssClass:"pdf-viewer-modal"})).present()}catch(r){console.error("Failed to view PDF",r),e.showToast("Failed to open PDF viewer","danger")}})()}downloadPDF(n){var e=this;return(0,x.A)(function*(){try{yield(yield e.toastController.create({message:"Downloading document...",duration:2e3,position:"bottom",color:"primary"})).present();let o=n.base64String;if(o.startsWith("data:")&&(o=o.split(",")[1]),y.Ii.isNativePlatform()){const c=`${n.displayName}.pdf`;try{const d=e.platform.is("android")?v.__.ExternalStorage:v.__.Documents,f=e.platform.is("android")?`Download/${c}`:c,P=yield v.YA.writeFile({path:f,data:o,directory:d,recursive:!0});console.log("File saved successfully to:",P.uri),yield(yield e.toastController.create({message:(e.platform.is("android"),"Downloaded successfully!"),duration:5e3,position:"bottom",color:"success",icon:"checkmark-circle",buttons:[{text:"Open",role:"action",handler:(b=(0,x.A)(function*(){try{yield M.M.open({filePath:P.uri,contentType:"application/pdf",openWithDefault:!0})}catch(C){console.error("Failed to open file:",C),e.showToast("Failed to open file","danger")}}),function(){return b.apply(this,arguments)})},{text:"Dismiss",role:"cancel"}]})).present()}catch(d){throw console.error("Filesystem error:",d),console.error("Error details:",JSON.stringify(d)),d}}else{const c=e.base64ToBlob(o,"application/pdf"),d=window.URL.createObjectURL(c),f=window.document.createElement("a");f.href=d,f.download=`${n.displayName}.pdf`,window.document.body.appendChild(f),f.click(),window.document.body.removeChild(f),window.URL.revokeObjectURL(d),yield(yield e.toastController.create({message:"Download completed successfully!",duration:2e3,position:"bottom",color:"success",icon:"checkmark-circle"})).present()}}catch(r){console.error("Failed to download PDF",r),e.showToast("Failed to download document","danger")}var b})()}base64ToBlob(n,e){const r=window.atob(n),o=new Uint8Array(r.length);for(let m=0;m<r.length;m++)o[m]=r.charCodeAt(m);return new Blob([o],{type:e})}showToast(n){var e=this;return(0,x.A)(function*(r,o="primary"){yield(yield e.toastController.create({message:r,duration:2500,position:"bottom",color:o})).present()}).apply(this,arguments)}formatDate(n){return n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A"}getDurationText(n,e){const m=n*e;return 1===m?"1 day":m<7?`${m} days`:7===m?"1 week":m<30?`${Math.round(m/7)} weeks`:m<365?`${Math.round(m/30)} months`:`${Math.round(m/365)} years`}getPrescriptionSections(n){var e;const r=[];return null!==(e=n.templateData)&&void 0!==e&&e.frames&&n.templateData.frames.forEach(o=>{o.sections&&r.push(...o.sections)}),r}togglePrescriptionDetails(){this.showPrescriptionDetails=!this.showPrescriptionDetails}isDrugActive(n){if(!n.startDateTime||!n.endDateTime)return!1;const e=new Date,r=new Date(n.startDateTime),o=new Date(n.endDateTime);return e>=r&&e<=o}getDrugStatusLabel(n){if(!n.startDateTime||!n.endDateTime)return"Unknown";const e=new Date,r=new Date(n.startDateTime),o=new Date(n.endDateTime);return e<r?"Upcoming":e>o?"Expired":"Active"}getDrugStatusClass(n){return`status-${this.getDrugStatusLabel(n).toLowerCase()}`}toggleExpiredSection(){this.isExpiredSectionOpen=!this.isExpiredSectionOpen}}return(i=s).\u0275fac=function(n){return new(n||i)(t.rXU(S.Ix),t.rXU(j.k),t.rXU(p.Xi),t.rXU(V.o),t.rXU(N.OD),t.rXU(p.K_),t.rXU(Y.V),t.rXU(p.W3))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-prescription-visit-detail"]],standalone:!0,features:[t.aNF],decls:3,vars:2,consts:[[1,"prescription-detail-page"],["class","loading-container",4,"ngIf"],["class","container",4,"ngIf"],[1,"loading-container"],["name","crescent"],[1,"loading-text"],[1,"container"],[3,"summary",4,"ngIf"],["class","section section-collapsible","aria-expanded","isActiveSectionOpen","aria-controls","active-items-container",3,"section-open","click",4,"ngIf"],["id","active-items-container","class","collapsible-content",4,"ngIf"],["class","section section-collapsible mt20","aria-expanded","isExpiredSectionOpen","aria-controls","expired-items-container",3,"section-open","click",4,"ngIf"],["id","expired-items-container","class","collapsible-content",4,"ngIf"],["class","section mt26",4,"ngIf"],[3,"doc","view","download",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[3,"summary"],["aria-expanded","isActiveSectionOpen","aria-controls","active-items-container",1,"section","section-collapsible",3,"click"],[1,"header-right"],[1,"count"],["name","chevron-down-outline",1,"chevron-icon"],["id","active-items-container",1,"collapsible-content"],[3,"item",4,"ngFor","ngForOf"],[3,"item"],["aria-expanded","isExpiredSectionOpen","aria-controls","expired-items-container",1,"section","section-collapsible","mt20",3,"click"],["id","expired-items-container",1,"collapsible-content"],[1,"section","mt26"],[3,"view","download","doc"],[1,"empty-state"],["name","medkit-outline",1,"empty-icon"],[1,"help-text"]],template:function(n,e){1&n&&(t.j41(0,"ion-content",0),t.DNE(1,G,4,0,"div",1)(2,Q,9,8,"main",2),t.k0s()),2&n&&(t.R7$(),t.Y8G("ngIf",e.isLoading),t.R7$(),t.Y8G("ngIf",!e.isLoading))},dependencies:[p.bv,p.W9,p.iq,p.w2,h.pM,h.bT,h.MD,u,T,$],styles:[".section-collapsible[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:var(--mc-spacing-sm) 0;margin:var(--mc-spacing-md) 0 var(--mc-spacing-sm);border-radius:var(--mc-radius-md);transition:all var(--mc-transition-base)}.section-collapsible[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--mc-font-body-lg);font-weight:600;color:var(--mc-text-primary);margin:0;letter-spacing:-.01em}.section-collapsible[_ngcontent-%COMP%]:hover{background-color:var(--mc-bg-secondary);padding-left:var(--mc-spacing-sm);padding-right:var(--mc-spacing-sm)}.section-collapsible[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--mc-spacing-xs)}.section-collapsible[_ngcontent-%COMP%]   .chevron-icon[_ngcontent-%COMP%]{font-size:18px;color:var(--mc-text-tertiary);transition:transform var(--mc-transition-base)}.section-collapsible.section-open[_ngcontent-%COMP%]   .chevron-icon[_ngcontent-%COMP%]{transform:rotate(180deg)}.collapsible-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .4s ease-out;padding-top:var(--mc-spacing-xs)}.prescription-detail-page[_ngcontent-%COMP%]{--background: var(--mc-bg-primary);--padding-top: var(--mc-spacing-lg);--padding-bottom: 0}.prescription-detail-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:0 var(--mc-spacing-lg);padding-bottom:100px}@media (max-width: 600px){.prescription-detail-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:0 var(--mc-spacing-md);padding-bottom:100px}}@supports (padding-bottom: env(safe-area-inset-bottom)){.prescription-detail-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding-bottom:calc(100px + env(safe-area-inset-bottom))}}.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{margin:var(--mc-spacing-lg) 0 var(--mc-spacing-sm);display:flex;align-items:center;justify-content:space-between}.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--mc-font-body-lg);color:var(--mc-text-primary);font-weight:600;letter-spacing:-.01em;margin:0}.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{background:var(--mc-color-primary-500);color:var(--mc-text-inverse);border-radius:var(--mc-radius-full);padding:3px var(--mc-spacing-sm);font-size:11px;font-weight:600;line-height:1.2;min-width:24px;text-align:center}.prescription-detail-page[_ngcontent-%COMP%]   .mt20[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-lg)}.prescription-detail-page[_ngcontent-%COMP%]   .mt26[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-xl)}.prescription-detail-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--mc-spacing-xl) var(--mc-spacing-lg);min-height:200px;gap:var(--mc-spacing-md);animation:_ngcontent-%COMP%_fadeIn .5s ease-out}.prescription-detail-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{--color: var(--mc-color-primary-500);width:40px;height:40px}.prescription-detail-page[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   .loading-text[_ngcontent-%COMP%]{color:var(--mc-text-secondary);font-size:var(--mc-font-body-md);font-weight:500;margin:0}.prescription-detail-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--mc-spacing-xl) var(--mc-spacing-lg);text-align:center;animation:_ngcontent-%COMP%_fadeInUp .5s ease-out;background:var(--mc-bg-card);border-radius:var(--mc-radius-lg);border:1px solid var(--mc-card-border);margin:var(--mc-spacing-lg) 0}.prescription-detail-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;color:var(--mc-color-gray-400);margin-bottom:var(--mc-spacing-md);opacity:.8}.prescription-detail-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md);font-weight:500;color:var(--mc-text-secondary);margin:var(--mc-spacing-xs) 0;max-width:320px}.prescription-detail-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p.help-text[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm);font-weight:400;color:var(--mc-text-tertiary);margin-top:var(--mc-spacing-xs)}@media (max-width: 600px){.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{margin:var(--mc-spacing-md) 0 var(--mc-spacing-sm)}.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md)}.prescription-detail-page[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-size:10px;padding:2px var(--mc-spacing-xs)}.prescription-detail-page[_ngcontent-%COMP%]   .section-collapsible[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]}),s})()},8135:(F,O,l)=>{l.d(O,{V:()=>D});var x=l(4438),p=l(600),h=l(9012);let D=(()=>{var v;class y{constructor(t,u){this.platform=t,this.router=u,this.activeSubscriptions=new Map}setupBackButton(t,u){Array.isArray(t)?t.forEach(_=>{this.setupSingleBackButton(_.route,_.handler)}):"string"==typeof t&&u&&this.setupSingleBackButton(t,u)}setupSingleBackButton(t,u){this.cleanupBackButton(t);const _=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===t&&u()});this.activeSubscriptions.set(t,_)}cleanupBackButton(t){const u=this.activeSubscriptions.get(t);u&&(u.unsubscribe(),this.activeSubscriptions.delete(t))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((t,u)=>{t.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(t="/home"){window.history.length>1?window.history.back():this.router.navigate([t])}smartNavigateBack(t){const _={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[t];_?this.router.navigate([_]):this.navigateBack()}}return(v=y).\u0275fac=function(t){return new(t||v)(x.KVO(p.OD),x.KVO(h.Ix))},v.\u0275prov=x.jDH({token:v,factory:v.\u0275fac,providedIn:"root"}),y})()}}]);