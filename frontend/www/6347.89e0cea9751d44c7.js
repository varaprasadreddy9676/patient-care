"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6347],{6347:(R,u,o)=>{o.r(u),o.d(u,{ReminderPage:()=>B});var f=o(467),m=o(9893),v=o(177),e=o(4438),p=o(3629),P=o(8023),O=o(7031),n=o(9012),c=o(9934),g=o(600),y=o(8251),E=o(8135);const w=(i,l)=>({pulse:!0,warning:i,urgent:l});function x(i,l){1&i&&(e.qex(0),e.j41(1,"div",2)(2,"ion-text",3)(3,"h3",4),e.EFF(4,"No upcoming reminders"),e.k0s()()(),e.bVm())}function T(i,l){if(1&i&&(e.j41(0,"p"),e.EFF(1),e.k0s()),2&i){const a=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",a.reminderDetails.appointmentTime," ")}}function k(i,l){if(1&i&&(e.j41(0,"p",19),e.EFF(1," Your video consultation will begin in "),e.j41(2,"span",20),e.EFF(3),e.k0s()()),2&i){const a=e.XpG(3);e.Y8G("ngClass",e.l_i(2,w,"warning"===a.timeState,"urgent"===a.timeState)),e.R7$(3),e.JRh(a.timeRemaining)}}function I(i,l){if(1&i){const a=e.RV6();e.j41(0,"ion-card",7),e.bIt("click",function(){e.eBV(a);const r=e.XpG().$implicit,s=e.XpG();return e.Njj(s.goToAppointment(r.objectId))}),e.j41(1,"ion-card-header",8)(2,"div",9)(3,"h2",10),e.EFF(4),e.k0s(),e.j41(5,"p",11)(6,"b"),e.EFF(7,"ID"),e.k0s(),e.EFF(8),e.k0s()()(),e.j41(9,"ion-card-content")(10,"div",12),e.nrm(11,"ion-icon",13),e.j41(12,"div",14)(13,"strong"),e.EFF(14),e.k0s(),e.j41(15,"p"),e.EFF(16),e.k0s()()(),e.j41(17,"div",12),e.nrm(18,"ion-icon",15),e.j41(19,"div",14)(20,"span"),e.EFF(21),e.k0s()()(),e.j41(22,"div",12),e.nrm(23,"ion-icon",16),e.j41(24,"div",14),e.DNE(25,T,2,1,"p",0)(26,k,4,5,"p",17),e.k0s()(),e.j41(27,"div",12),e.nrm(28,"ion-icon",18),e.j41(29,"div",14)(30,"p"),e.EFF(31),e.k0s()()()()()}if(2&i){const a=e.XpG().$implicit,t=e.XpG();e.R7$(4),e.JRh(a.familyMemberName),e.R7$(4),e.SpI(" : ",a.reminderDetails.bookingId,""),e.R7$(6),e.JRh(a.reminderDetails.doctorName),e.R7$(2),e.JRh(a.reminderDetails.specialityName),e.R7$(5),e.JRh(t.dateValidation(a.reminderDetails.appointmentDate)),e.R7$(4),e.Y8G("ngIf","Be Ready for the Video Consultation"!==a.reminderNotificationDetails.title),e.R7$(),e.Y8G("ngIf","Be Ready for the Video Consultation"===a.reminderNotificationDetails.title),e.R7$(5),e.JRh(a.reminderDetails.hospitalName)}}function S(i,l){if(1&i&&(e.j41(0,"ion-col",5),e.DNE(1,I,32,8,"ion-card",6),e.k0s()),2&i){const a=l.$implicit;e.R7$(),e.Y8G("ngIf","APPOINTMENT"===a.reminderType)}}let B=(()=>{var i;class l{constructor(t,r,s,d,h,M,b,_){this.storageService=t,this.httpService=r,this.dateService=s,this.router=d,this.utilityService=h,this.platform=M,this.navService=b,this.pageNavService=_,this.reminder=[],this.reminders=[],this.noReminders=!1,this.timeRemaining="",this.appointmentTime="",this.timeState="normal",this.navService.pageChange("Reminders"),this.user=this.storageService.get("user"),this.getReminders()}ngOnInit(){this.calculateTimeRemaining(),this.timer=setInterval(()=>this.calculateTimeRemaining(),1e3)}ngOnDestroy(){this.timer&&clearInterval(this.timer),this.pageNavService.cleanup()}ionViewWillEnter(){this.navService.pageChange("Reminders"),this.pageNavService.setupBackButton("/reminder",()=>{this.router.navigate(["home"])})}calculateTimeRemaining(){const t=this.reminders.find(U=>"Be Ready for the Video Consultation"===U.reminderNotificationDetails.title);if(!t)return;const r=t.reminderDetails.appointmentTime,s=new Date,[d,h]=r.split(" "),[M,b]=d.split(":");let _=parseInt(M);"pm"===h.toLowerCase()&&12!==_?_+=12:"am"===h.toLowerCase()&&12===_&&(_=0);const F=new Date(s.getFullYear(),s.getMonth(),s.getDate(),_,parseInt(b)),N=(new Date).getTime(),D=F.getTime()-N;if(D<=0)return this.timeRemaining="Consultation is starting now",void(this.timeState="urgent");const C=Math.floor(D%36e5/6e4),A=Math.floor(D%6e4/1e3);this.timeState=C<2?"urgent":C<5?"warning":"normal",this.timeRemaining=`${C}m ${A}s`}dateValidation(t){return this.pendingDate=new Date(t).getDate()-(new Date).getDate(),this.pendingDate=0===this.pendingDate?"Today":1===this.pendingDate?"Tomorrow":this.dateService.toDBdateFormat(new Date(t)),this.pendingDate}mockReminders(){const t=new Date;t.setMinutes(t.getMinutes()+1);const r=[{remindAt:new Date,reminderType:"APPOINTMENT",objectId:"123",familyMemberName:"Test Patient",reminderDetails:{bookingId:"TEST123",doctorName:"Dr. Test",specialityName:"Testing",appointmentDate:new Date,appointmentTime:t.toISOString(),hospitalName:"Test Hospital"},reminderNotificationDetails:{title:"Be Ready for the Video Consultation"}}];this.reminder=r,this.reminders=r,this.noReminders=!1,this.calculateTimeRemaining()}getReminders(){var t=this;return(0,f.A)(function*(){const r="/reminder/?userId="+t.user.id;yield t.httpService.get(r).then(s=>{if(s){for(let d=0;d<s.length;d++)s[d].reminderDetails.appointmentTime=t.dateService.to12HourFormat(s[d].reminderDetails.appointmentTime),t.reminder.push(s[d]);t.reminders=t.reminder.sort((d,h)=>new Date(d.remindAt).getDate()-new Date(h.remindAt).getDate()),t.calculateTimeRemaining()}t.reminders.length>0||(t.noReminders=!0)}).catch(s=>{t.utilityService.presentAlert("Error!",s.message)})})()}goToAppointment(t){this.router.navigate(["/home/appointment-details"],{state:{appointmentDetails:{_id:t}}})}markRemindersAsRead(){this.httpService.get("/reminder/markasread/?userId="+this.user.id).then(r=>{}).catch(r=>{})}}return(i=l).\u0275fac=function(t){return new(t||i)(e.rXU(p.n),e.rXU(P.k),e.rXU(O.k),e.rXU(n.Ix),e.rXU(c.Q),e.rXU(g.OD),e.rXU(y.o),e.rXU(E.V))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-reminder"]],standalone:!0,features:[e.aNF],decls:5,vars:2,consts:[[4,"ngIf"],["size","12","size-sm","6","size-md","6","size-lg","4",4,"ngFor","ngForOf"],[1,"empty-state"],["color","medium"],[1,"text-lg"],["size","12","size-sm","6","size-md","6","size-lg","4"],["class","reminder-card",3,"click",4,"ngIf"],[1,"reminder-card",3,"click"],[1,"ion-no-padding"],[1,"header-content","ion-padding"],[1,"patient-name"],[1,"booking-id"],[1,"detail-row"],["name","person"],[1,"detail-content"],["name","calendar"],["name","time"],["class","video-alert",3,"ngClass",4,"ngIf"],["name","business"],[1,"video-alert",3,"ngClass"],[1,"timer-text"]],template:function(t,r){1&t&&(e.j41(0,"ion-content"),e.DNE(1,x,5,0,"ng-container",0),e.j41(2,"ion-grid")(3,"ion-row"),e.DNE(4,S,2,1,"ion-col",1),e.k0s()()()),2&t&&(e.R7$(),e.Y8G("ngIf",r.noReminders),e.R7$(3),e.Y8G("ngForOf",r.reminders))},dependencies:[m.bv,m.b_,m.I9,m.ME,m.hU,m.W9,m.lO,m.iq,m.ln,m.IO,v.bT,v.pM,v.YU],styles:["[_nghost-%COMP%]{display:block}ion-header[_ngcontent-%COMP%]{background:transparent}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--border-width: 0;padding:var(--mc-spacing-sm) var(--mc-spacing-md)}ion-grid[_ngcontent-%COMP%]{margin-bottom:var(--mc-spacing-lg)}.page-title[_ngcontent-%COMP%]{text-align:center;font-size:var(--mc-font-display-md);font-weight:var(--font-weight-semibold);font-family:Poppins;margin:var(--mc-spacing-md) 0 0;color:var(--mc-text-primary)}.empty-state[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%;text-align:center;padding:var(--mc-spacing-2xl)}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-weight:var(--font-weight-medium);font-family:Poppins;color:var(--mc-text-secondary)}.reminder-card[_ngcontent-%COMP%]{margin:var(--mc-spacing-md);border-radius:var(--mc-radius-lg);box-shadow:var(--mc-shadow-sm);overflow:hidden;transition:var(--transition);background:var(--mc-bg-inverse);border:1px solid var(--mc-border-primary)}.reminder-card[_ngcontent-%COMP%]:hover{box-shadow:var(--mc-shadow-md);transform:translateY(-1px)}.header-content[_ngcontent-%COMP%]{background-color:var(--mc-color-primary-500);padding:var(--mc-spacing-md)}.patient-name[_ngcontent-%COMP%], .booking-id[_ngcontent-%COMP%]{font-family:Poppins;color:var(--mc-text-inverse)}.patient-name[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg);font-weight:var(--font-weight-semibold);margin-bottom:var(--mc-spacing-xs)}.booking-id[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md);margin:0;color:#ffffffe6}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding:var(--mc-spacing-sm) 0}.detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-xl);margin-right:var(--mc-spacing-md);min-width:24px;color:var(--mc-color-primary-500)}.detail-content[_ngcontent-%COMP%]{flex:1;color:var(--mc-text-primary)}.detail-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:var(--mc-spacing-xs);color:var(--mc-text-primary);font-family:Poppins;font-weight:var(--font-weight-medium)}.detail-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:var(--mc-font-body-md);font-family:Poppins;color:var(--mc-text-secondary)}.video-consultation[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{background-color:var(--mc-color-success-500)}.video-alert[_ngcontent-%COMP%]{border-radius:var(--mc-radius-sm);background-color:var(--mc-color-secondary-50);margin:var(--mc-spacing-sm) 0;transition:var(--transition);border-left:4px solid var(--mc-color-secondary-300)}.video-alert.warning[_ngcontent-%COMP%]{background-color:var(--mc-color-warning-50);color:var(--mc-color-warning-700);border-left-color:var(--mc-color-warning-300)}.video-alert.urgent[_ngcontent-%COMP%]{background-color:var(--mc-color-danger-50);color:var(--mc-color-danger-700);border-left-color:var(--mc-color-danger-300)}.timer-text[_ngcontent-%COMP%]{font-weight:var(--font-weight-semibold);margin-left:var(--mc-spacing-xs)}.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation 2s infinite}@keyframes _ngcontent-%COMP%_pulse-animation{0%{box-shadow:0 0 #007bff33}70%{box-shadow:0 0 0 10px #007bff00}to{box-shadow:0 0 #007bff00}}.warning.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation-warning 2s infinite}.urgent.pulse[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-animation-urgent 1.5s infinite}@keyframes _ngcontent-%COMP%_pulse-animation-warning{0%{box-shadow:0 0 #ffc10733}70%{box-shadow:0 0 0 10px #ffc10700}to{box-shadow:0 0 #ffc10700}}@keyframes _ngcontent-%COMP%_pulse-animation-urgent{0%{box-shadow:0 0 #dc354533}70%{box-shadow:0 0 0 10px #dc354500}to{box-shadow:0 0 #dc354500}}.urgent[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_shake .82s cubic-bezier(.36,.07,.19,.97) both}@keyframes _ngcontent-%COMP%_shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(2px,0,0)}30%,50%,70%{transform:translate3d(-4px,0,0)}40%,60%{transform:translate3d(4px,0,0)}}@media (max-width: 768px){.reminder-card[_ngcontent-%COMP%]{margin:var(--mc-spacing-sm);border-radius:var(--mc-radius-md)}.header-content[_ngcontent-%COMP%]{padding:var(--mc-spacing-sm) var(--mc-spacing-md)}.patient-name[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-md)}.detail-row[_ngcontent-%COMP%]{padding:var(--mc-spacing-xs) 0}.detail-row[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg);margin-right:var(--mc-spacing-sm)}}@media (max-width: 480px){.page-title[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg)}.detail-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md)}.detail-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm)}}"]}),l})()},8135:(R,u,o)=>{o.d(u,{V:()=>e});var f=o(4438),m=o(600),v=o(9012);let e=(()=>{var p;class P{constructor(n,c){this.platform=n,this.router=c,this.activeSubscriptions=new Map}setupBackButton(n,c){Array.isArray(n)?n.forEach(g=>{this.setupSingleBackButton(g.route,g.handler)}):"string"==typeof n&&c&&this.setupSingleBackButton(n,c)}setupSingleBackButton(n,c){this.cleanupBackButton(n);const g=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===n&&c()});this.activeSubscriptions.set(n,g)}cleanupBackButton(n){const c=this.activeSubscriptions.get(n);c&&(c.unsubscribe(),this.activeSubscriptions.delete(n))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((n,c)=>{n.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(n="/home"){window.history.length>1?window.history.back():this.router.navigate([n])}smartNavigateBack(n){const g={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[n];g?this.router.navigate([g]):this.navigateBack()}}return(p=P).\u0275fac=function(n){return new(n||p)(f.KVO(m.OD),f.KVO(v.Ix))},p.\u0275prov=f.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),P})()}}]);