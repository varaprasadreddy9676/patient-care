"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5660],{5660:(I,M,c)=>{c.r(M),c.d(M,{EmrPage:()=>vt});var v=c(467),m=c(9893),f=c(177),t=c(4438),h=c(9012),y=c(600),R=c(3629),s=c(8023),d=c(7031),g=c(9934),F=c(345),x=c(8135);function T(e,a){1&e&&(t.j41(0,"div",4),t.nrm(1,"ion-icon",5),t.j41(2,"p"),t.EFF(3,"No medical records available for this visit."),t.k0s()())}function $(e,a){1&e&&(t.j41(0,"div",12),t.nrm(1,"ion-icon",21),t.j41(2,"div",14),t.EFF(3,"Video consultation"),t.k0s()())}function j(e,a){1&e&&(t.j41(0,"div",12),t.nrm(1,"ion-icon",22),t.j41(2,"div",14),t.EFF(3,"Consultation at Hospital"),t.k0s()())}function D(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.Lme(" ",i.problemDescription," since ",i.remarks," ")}}function G(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Chief Complaint"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,D,2,2,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.cheifComplaints)}}function S(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.SpI(" ",i.allergyWith," ")}}function N(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Allergies"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,S,2,1,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.allergies)}}function B(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.E5c(" ",i.itemName," - ",i.observedValue," ",i.unit," ")}}function w(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Vital Signs"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,B,2,3,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.vitalSigns)}}function Y(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.SpI(" ",i.name," ")}}function A(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Diagnosis"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,Y,2,1,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.diagnosis)}}function U(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.SpI(" ",i.visitNote," ")}}function z(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Notes"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,U,2,1,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.notes)}}function X(e,a){if(1&e&&t.nrm(0,"div",37),2&e){const i=t.XpG().$implicit;t.Y8G("innerHtml",i.reportTemplate,t.npT)}}function V(e,a){if(1&e&&(t.j41(0,"ion-row",38)(1,"ion-col",39)(2,"div"),t.EFF(3," Signed By: "),t.k0s(),t.j41(4,"div"),t.EFF(5),t.k0s()(),t.j41(6,"ion-col",40)(7,"div",41)(8,"div"),t.EFF(9," Date: "),t.k0s(),t.j41(10,"div"),t.EFF(11),t.k0s()()()()),2&e){const i=t.XpG().$implicit;t.R7$(5),t.SpI(" ",i.doctor.signedDoctorName," "),t.R7$(6),t.SpI(" ",i.signedDateTime.split(" ")[0]," ")}}function L(e,a){if(1&e){const i=t.RV6();t.j41(0,"ion-col",45)(1,"ion-button",46)(2,"img",47),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(6);return t.Njj(r.openFile(o))}),t.k0s(),t.j41(3,"div",48),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(6);return t.Njj(r.openFile(o))}),t.nrm(4,"ion-icon",49),t.j41(5,"span",50),t.EFF(6),t.k0s()()(),t.j41(7,"div",51),t.EFF(8),t.k0s()()}if(2&e){const i=a.$implicit,n=t.XpG(6);t.R7$(),t.Y8G("disabled",n.disableThumbnailClick),t.R7$(),t.Y8G("hidden","image"!=i.contentType.split("/")[0])("src",n.sanitizeBase64URI(i.base64DataURI),t.B4B),t.R7$(),t.Y8G("hidden","image"==i.contentType.split("/")[0]),t.R7$(3),t.SpI(" ",i.contentType.split("/")[1]," "),t.R7$(2),t.SpI(" ",i.fileName," ")}}function W(e,a){if(1&e&&(t.j41(0,"ion-grid",42)(1,"ion-row",43),t.DNE(2,L,9,6,"ion-col",44),t.k0s()()),2&e){const i=t.XpG().$implicit;t.R7$(2),t.Y8G("ngForOf",i.attachments)}}function K(e,a){if(1&e&&(t.j41(0,"div",29)(1,"div",30)(2,"ion-row",31)(3,"ion-col",32),t.EFF(4),t.k0s(),t.j41(5,"ion-col",33),t.EFF(6),t.k0s()(),t.DNE(7,X,1,1,"div",34)(8,V,12,2,"ion-row",35),t.k0s(),t.DNE(9,W,3,1,"ion-grid",36),t.k0s()),2&e){const i=a.$implicit,n=a.index;t.R7$(4),t.Lme(" ",n+1,". ",i.serviceName," "),t.R7$(2),t.SpI(" ",i.serviceStatus," "),t.R7$(),t.Y8G("ngIf","PROCESSED"==i.serviceStatus&&i.reportTemplate),t.R7$(),t.Y8G("ngIf","PROCESSED"==i.serviceStatus),t.R7$(),t.Y8G("ngIf",i.attachments&&i.attachments.length>0)}}function H(e,a){if(1&e&&(t.j41(0,"div"),t.DNE(1,K,10,6,"div",28),t.k0s()),2&e){const i=t.XpG(3);t.R7$(),t.Y8G("ngForOf",i.radiologyReports.radiologyReportList)}}function J(e,a){if(1&e&&t.nrm(0,"div",37),2&e){const i=t.XpG().$implicit;t.Y8G("innerHtml",i.reportTemplate,t.npT)}}function Q(e,a){if(1&e&&(t.j41(0,"ion-row")(1,"ion-col",56),t.EFF(2),t.k0s(),t.j41(3,"ion-col",60),t.EFF(4),t.k0s(),t.j41(5,"ion-col",58),t.EFF(6),t.k0s(),t.j41(7,"ion-col",59),t.EFF(8),t.k0s()()),2&e){const i=a.$implicit;t.R7$(2),t.SpI(" ",i.testName," "),t.R7$(2),t.SpI(" ",i.testValue," "),t.R7$(2),t.SpI(" ",i.unit," "),t.R7$(2),t.SpI(" ",i.normalRange," ")}}function Z(e,a){if(1&e&&(t.j41(0,"div",54)(1,"ion-grid")(2,"ion-row",55)(3,"ion-col",56),t.EFF(4," Test Name"),t.k0s(),t.j41(5,"ion-col",57),t.EFF(6,"Test Value "),t.k0s(),t.j41(7,"ion-col",58),t.EFF(8,"Unit"),t.k0s(),t.j41(9,"ion-col",59),t.EFF(10," Normal Range"),t.k0s()(),t.DNE(11,Q,9,4,"ion-row",26),t.k0s()()),2&e){const i=t.XpG().$implicit;t.R7$(11),t.Y8G("ngForOf",i.reportObservations)}}function q(e,a){if(1&e&&(t.j41(0,"div",61)(1,"ion-grid")(2,"ion-row")(3,"ion-col",62),t.EFF(4),t.k0s()()()()),2&e){const i=t.XpG().$implicit;t.R7$(4),t.Lme(" ",i.serviceName,": ",i.resultValue," ")}}function tt(e,a){if(1&e&&(t.j41(0,"ion-row",38)(1,"ion-col",39)(2,"div"),t.EFF(3," Signed By: "),t.k0s(),t.j41(4,"div"),t.EFF(5),t.k0s()(),t.j41(6,"ion-col",40)(7,"div",41)(8,"div"),t.EFF(9," Date: "),t.k0s(),t.j41(10,"div"),t.EFF(11),t.k0s()()()()),2&e){const i=t.XpG().$implicit;t.R7$(5),t.SpI(" ",i.signedBy.name," "),t.R7$(6),t.SpI(" ",i.signedBy.signedDateTime.split(" ")[0]," ")}}function it(e,a){if(1&e){const i=t.RV6();t.j41(0,"ion-col",45)(1,"ion-button",46)(2,"img",47),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(6);return t.Njj(r.openFile(o))}),t.k0s(),t.j41(3,"div",48),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(6);return t.Njj(r.openFile(o))}),t.nrm(4,"ion-icon",49),t.j41(5,"span",50),t.EFF(6),t.k0s()()(),t.j41(7,"div",51),t.EFF(8),t.k0s()()}if(2&e){const i=a.$implicit,n=t.XpG(6);t.R7$(),t.Y8G("disabled",n.disableThumbnailClick),t.R7$(),t.Y8G("hidden","image"!=i.contentType.split("/")[0])("src",n.sanitizeBase64URI(i.base64DataURI),t.B4B),t.R7$(),t.Y8G("hidden","image"==i.contentType.split("/")[0]),t.R7$(3),t.SpI(" ",i.contentType.split("/")[1]," "),t.R7$(2),t.SpI(" ",i.fileName," ")}}function et(e,a){if(1&e&&(t.j41(0,"ion-grid",42)(1,"ion-row",43),t.DNE(2,it,9,6,"ion-col",44),t.k0s()()),2&e){const i=t.XpG().$implicit;t.R7$(2),t.Y8G("ngForOf",i.attachments)}}function nt(e,a){if(1&e&&(t.j41(0,"div",29)(1,"div",30)(2,"ion-row",31)(3,"ion-col",32),t.EFF(4),t.k0s(),t.j41(5,"ion-col",33),t.EFF(6),t.nI1(7,"uppercase"),t.k0s()(),t.DNE(8,J,1,1,"div",34)(9,Z,12,1,"div",52)(10,q,5,2,"div",53)(11,tt,12,2,"ion-row",35),t.k0s(),t.DNE(12,et,3,1,"ion-grid",36),t.k0s()),2&e){const i=a.$implicit,n=a.index,o=t.XpG(4);t.R7$(4),t.Lme(" ",o.radiologyReports?o.radiologyReports.radiologyReportList.length+n+1:n+1,". ",i.serviceName," "),t.R7$(2),t.SpI(" ",t.bMT(7,8,i.status)," "),t.R7$(2),t.Y8G("ngIf","Processed"==i.status&&i.reportTemplate),t.R7$(),t.Y8G("ngIf",i.reportObservations&&"OBSERVATIONS"===i.resultType&&"Processed"==i.status),t.R7$(),t.Y8G("ngIf","Processed"==i.status&&i.resultValue&&"TEMPLATE"===i.resultType&&!i.reportTemplate),t.R7$(),t.Y8G("ngIf","Processed"==i.status),t.R7$(),t.Y8G("ngIf",i.attachments&&i.attachments.length>0)}}function ot(e,a){if(1&e&&(t.j41(0,"div"),t.DNE(1,nt,13,10,"div",28),t.k0s()),2&e){const i=t.XpG(3);t.R7$(),t.Y8G("ngForOf",i.labReports.labReports)}}function at(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Investigation"),t.k0s(),t.j41(3,"div",24),t.DNE(4,H,2,1,"div",27)(5,ot,2,1,"div",27),t.k0s()()),2&e){const i=t.XpG(2);t.R7$(4),t.Y8G("ngIf",i.radiologyReports),t.R7$(),t.Y8G("ngIf",i.labReports)}}function rt(e,a){if(1&e&&(t.j41(0,"div",68)(1,"span",69),t.EFF(2),t.k0s(),t.j41(3,"div",70)(4,"div",71),t.EFF(5),t.k0s(),t.j41(6,"div",72),t.EFF(7),t.k0s()()()),2&e){const i=a.$implicit,n=a.index;t.R7$(2),t.SpI("",n+1,"."),t.R7$(3),t.JRh(i.drugName),t.R7$(2),t.Lme("",i.dosageDesc," x ",i.duration,"")}}function st(e,a){if(1&e){const i=t.RV6();t.j41(0,"div",23)(1,"div",63)(2,"h3",10),t.EFF(3,"Prescription"),t.k0s(),t.j41(4,"ion-button",64),t.bIt("click",function(){t.eBV(i);const o=t.XpG(2);return t.Njj(o.showPrescriptionPDF())}),t.nrm(5,"ion-icon",65),t.k0s()(),t.j41(6,"div",24)(7,"div",66),t.DNE(8,rt,8,4,"div",67),t.k0s()()()}if(2&e){const i=t.XpG(2);t.R7$(8),t.Y8G("ngForOf",i.emr.prescription)}}function ct(e,a){if(1&e&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&e){const i=a.$implicit;t.R7$(),t.SpI(" ",i.adiceNote," ")}}function dt(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Advice"),t.k0s(),t.j41(3,"div",24)(4,"ul",25),t.DNE(5,ct,2,1,"li",26),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.emr.advice)}}function lt(e,a){if(1&e){const i=t.RV6();t.j41(0,"ion-col",45)(1,"ion-button",46)(2,"img",47),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(3);return t.Njj(r.openFile(o))}),t.k0s(),t.j41(3,"div",48),t.bIt("click",function(){const o=t.eBV(i).$implicit,r=t.XpG(3);return t.Njj(r.openFile(o))}),t.nrm(4,"ion-icon",49),t.j41(5,"span",50),t.EFF(6),t.k0s()()()()}if(2&e){const i=a.$implicit,n=t.XpG(3);t.R7$(),t.Y8G("disabled",n.disableThumbnailClick),t.R7$(),t.Y8G("hidden","image"!=i.contentType.split("/")[0])("src",n.sanitizeBase64URI(i.base64DataURI),t.B4B),t.R7$(),t.Y8G("hidden","image"==i.contentType.split("/")[0]),t.R7$(3),t.SpI(" ",i.contentType.split("/")[1]," ")}}function _t(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Attachments"),t.k0s(),t.j41(3,"div",24)(4,"ion-row",43),t.DNE(5,lt,7,5,"ion-col",44),t.k0s()()()),2&e){const i=t.XpG(2);t.R7$(5),t.Y8G("ngForOf",i.visitAttachments)}}function mt(e,a){if(1&e&&(t.j41(0,"div",23)(1,"h3",10),t.EFF(2,"Discharge Summary"),t.k0s(),t.nrm(3,"div",73),t.k0s()),2&e){const i=t.XpG(2);t.R7$(3),t.Y8G("innerHtml",i.dischargeSummary.description,t.npT)}}function gt(e,a){if(1&e&&(t.j41(0,"div",6)(1,"header",7)(2,"h1"),t.EFF(3,"Medical Record"),t.k0s(),t.j41(4,"p",8),t.EFF(5,"Complete visit details and medical documentation"),t.k0s()(),t.j41(6,"div",9)(7,"h3",10),t.EFF(8,"Visit Information"),t.k0s(),t.j41(9,"div",11)(10,"div",12),t.nrm(11,"ion-icon",13),t.j41(12,"div",14),t.EFF(13),t.k0s()(),t.j41(14,"div",12),t.nrm(15,"ion-icon",15),t.j41(16,"div",14),t.EFF(17),t.nI1(18,"date"),t.k0s()(),t.j41(19,"div",12),t.nrm(20,"ion-icon",16),t.j41(21,"div",14)(22,"div",17),t.EFF(23),t.k0s(),t.j41(24,"div",18),t.EFF(25),t.k0s()()(),t.DNE(26,$,4,0,"div",19)(27,j,4,0,"div",19),t.k0s()(),t.DNE(28,G,6,1,"div",20)(29,N,6,1,"div",20)(30,w,6,1,"div",20)(31,A,6,1,"div",20)(32,z,6,1,"div",20)(33,at,6,2,"div",20)(34,st,9,1,"div",20)(35,dt,6,1,"div",20)(36,_t,6,1,"div",20)(37,mt,4,1,"div",20),t.k0s()),2&e){const i=t.XpG();t.R7$(13),t.JRh(null==i.emr||null==i.emr.visit?null:i.emr.visit.patientName),t.R7$(4),t.Lme(" ",t.i5U(18,17,null==i.emr||null==i.emr.visit?null:i.emr.visit.visitDate,"MMM dd, yyyy")," at ",null==i.emr||null==i.emr.visit?null:i.emr.visit.visitTime," "),t.R7$(6),t.JRh(i.sanitizeDoctorName(null==i.emr||null==i.emr.visit?null:i.emr.visit.doctorName)),t.R7$(2),t.JRh(null==i.emr||null==i.emr.visit?null:i.emr.visit.specialityName),t.R7$(),t.Y8G("ngIf",null==i.emr||null==i.emr.visit?null:i.emr.visit.videoConsultation),t.R7$(),t.Y8G("ngIf",!(null!=i.emr&&null!=i.emr.visit&&i.emr.visit.videoConsultation)),t.R7$(),t.Y8G("ngIf",i.emr.cheifComplaints.length>0),t.R7$(),t.Y8G("ngIf",i.emr.allergies.length>0),t.R7$(),t.Y8G("ngIf",i.emr.vitalSigns.length>0),t.R7$(),t.Y8G("ngIf",i.emr.diagnosis.length>0),t.R7$(),t.Y8G("ngIf",i.emr.notes.length>0),t.R7$(),t.Y8G("ngIf",i.radiologyReports||i.labReports),t.R7$(),t.Y8G("ngIf",i.emr.prescription.length>0),t.R7$(),t.Y8G("ngIf",i.emr.advice.length>0),t.R7$(),t.Y8G("ngIf",0!==i.visitAttachments.length),t.R7$(),t.Y8G("ngIf",i.dischargeSummary)}}function pt(e,a){if(1&e){const i=t.RV6();t.j41(0,"ion-fab",74)(1,"ion-avatar",75),t.bIt("click",function(){t.eBV(i);const o=t.XpG();return t.Njj(o.showEmrPDF())}),t.nrm(2,"img",76),t.k0s()()}}let vt=(()=>{var e;class a{constructor(n,o,r,l,_,p,ht,ft,ut){var u,P,E,C,O;this.router=n,this.navCtrl=o,this.storageService=r,this.httpService=l,this.dateService=_,this.utilityService=p,this.platform=ht,this.sanitizer=ft,this.pageNavService=ut,this.prescriptions=[],this.advices=[],this.isPrescription=!1,this.isAdvice=!1,this.isNotes=!1,this.notes=[],this.visitAttachments=[],this.disableThumbnailClick=!1,this.emrData=!1,this.user=this.storageService.get("user"),this.familyMemberId=null===(u=this.router.getCurrentNavigation())||void 0===u||null===(u=u.extras.state)||void 0===u?void 0:u.visitInformation.familyMemberId,this.patientId=null===(P=this.router.getCurrentNavigation())||void 0===P||null===(P=P.extras.state)||void 0===P?void 0:P.patientId,this.visitId=null===(E=this.router.getCurrentNavigation())||void 0===E||null===(E=E.extras.state)||void 0===E?void 0:E.visitId,this.gender=null===(C=this.router.getCurrentNavigation())||void 0===C||null===(C=C.extras.state)||void 0===C?void 0:C.visitInformation.familyMemberGender,this.hospitalCode=null===(O=this.router.getCurrentNavigation())||void 0===O||null===(O=O.extras.state)||void 0===O?void 0:O.hospitalCode,this.getEmr(),this.getAttachments();try{var b;this.fromAppointmentDetails=null===(b=this.router.getCurrentNavigation())||void 0===b||null===(b=b.extras.state)||void 0===b?void 0:b.fromAppointmentDetails}catch{}this.pageNavService.setupBackButton("/emr",()=>{this.fromAppointmentDetails?this.router.navigate(["/home/appointment-details"]):this.router.navigate(["/home/medical-record/visits"],{state:{familyMemberId:this.familyMemberId}})})}navigateBack(){this.fromAppointmentDetails?this.router.navigate(["/home/appointment-details"]):this.router.navigate(["/home/medical-record/visits"],{state:{familyMemberId:this.familyMemberId}})}getEmr(){var n=this;return(0,v.A)(function*(){const o="/emr/?familyMemberId="+n.familyMemberId+"&patientId="+n.patientId+"&visitId="+n.visitId;yield n.httpService.getInBackground(o,!0).then(r=>{r&&(n.emr=r.emrVisit,r.emrVisit.visit?(r.emrVisit.visit.visitDate=new Date(r.emrVisit.visit.visitDate),r.emrVisit.visit.visitTime=n.dateService.to12HourFormat(r.emrVisit.visit.visitTime),n.visits=r.emrVisit.visit,n.prescriptions=r.emrVisit.prescription,n.advices=r.emrVisit.advice,n.notes=r.emrVisit.notes,n.isNotes=n.notes.length>0,n.isPrescription=n.prescriptions.length>0,n.isAdvice=n.advices.length>0,n.getRadiologyReports(),n.getDischargeSummary(),n.getLabReports()):n.emrData=!0)}).catch(r=>{n.utilityService.presentAlert("Error!",r.message)})})()}getAttachments(){var n=this;return(0,v.A)(function*(){n.httpService.getInBackground("/attachment/contextAttachment?hospitalCode="+n.hospitalCode+"&contextId="+n.visitId+"&contextType=VISIT&addBase64String=true",!0).then(r=>{n.visitAttachments=r.data.attachments}).catch(r=>{})})()}sanitizeBase64URI(n){return this.sanitizer.bypassSecurityTrustResourceUrl(n)}saveAndOpenPdf(n,o){this.disableThumbnailClick=!1;const r=n,l=document.createElement("a"),_=o+".pdf";l.href=r,l.download=_,l.target="_blank",document.body.appendChild(l),l.click()}openFile(n){this.disableThumbnailClick=!0,this.httpService.getInBackground("/attachment/contextAttachment/open?hospitalCode="+this.hospitalCode+"&attachmentId="+n.id,!0).then(r=>{this.disableThumbnailClick=!1;const _=r.data.attachment.base64DataURI;if("image/png"!==r.data.attachment.contentType)return void this.saveAndOpenPdf(_,r.data.attachment.fileName);let p=document.createElement("a");p.href=_,p.download="Image.png",p.click()})}showPrescriptionPDF(){var n=this;return(0,v.A)(function*(){const o="/prescription/print/?hospitalCode="+n.emr.visit.entityCode+"&patientId="+n.emr.visit.patientId+"&visitId="+n.emr.visit.visitId;yield n.httpService.getInBackground(o,!0).then(r=>{if(r){const l="Prescription_"+n.visits.patientName+".pdf";let _=document.createElement("a");_.href="data:application/pdf;base64,"+r.prescriptionPrint,_.download=l,_.click()}}).catch(r=>{})})()}showEmrPDF(){var n=this;return(0,v.A)(function*(){const o="/emr/print/?hospitalCode="+n.emr.visit.entityCode+"&patientId="+n.emr.visit.patientId+"&visitId="+n.emr.visit.visitId;yield n.httpService.getInBackground(o,!0).then(r=>{if(r){const l="VisitRecord_"+n.visits.patientName+".pdf",_=`data:application/pdf;base64,${r.EMRPrint}`,p=document.createElement("a");p.href=_,p.download=l,p.click()}}).catch(r=>{})})()}getDischargeSummary(){this.httpService.getInBackground("/dischargeSummary/?hospitalCode="+this.emr.visit.entityCode+"&patientId="+this.emr.visit.patientId+"&visitId="+this.emr.visit.visitId,!0).then(o=>{o&&(this.dischargeSummary=o)}).catch(o=>{})}getRadiologyReports(){this.httpService.getInBackground("/labReports/radiology/?hospitalCode="+this.emr.visit.entityCode+"&patientId="+this.emr.visit.patientId+"&visitId="+this.emr.visit.visitId,!0).then(o=>{o&&o.radiologyReportList.length>0&&(this.radiologyReports=o)}).catch(o=>{})}getLabReports(){this.httpService.getInBackground("/labReports/?hospitalCode="+this.emr.visit.entityCode+"&patientId="+this.emr.visit.patientId+"&visitId="+this.emr.visit.visitId,!0).then(o=>{o&&o.labReports.length>0&&(this.labReports=o)}).catch(o=>{})}sanitizeDoctorName(n){if(!n)return"";const o=n.trim();return o.toLowerCase().startsWith("dr.")||o.toLowerCase().startsWith("dr ")?o:"Dr. "+o}ngOnDestroy(){this.pageNavService.cleanup()}}return(e=a).\u0275fac=function(n){return new(n||e)(t.rXU(h.Ix),t.rXU(y.q9),t.rXU(R.n),t.rXU(s.k),t.rXU(d.k),t.rXU(g.Q),t.rXU(y.OD),t.rXU(F.up),t.rXU(x.V))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-emr"]],standalone:!0,features:[t.aNF],decls:4,vars:3,consts:[[1,"emr-page"],["class","empty-state",4,"ngIf"],["class","container",4,"ngIf"],["class","button-secondary","style","cursor: pointer;","vertical","bottom","horizontal","end","slot","fixed","margin-end","","margin-bottom","",4,"ngIf"],[1,"empty-state"],["name","document-text-outline",1,"empty-icon"],[1,"container"],[1,"header"],[1,"subtitle"],[1,"visit-card"],[1,"section-title"],[1,"visit-details"],[1,"detail-item"],["name","person-outline",1,"detail-icon"],[1,"detail-content"],["name","calendar-outline",1,"detail-icon"],["name","medical-outline",1,"detail-icon"],[1,"doctor-name"],[1,"specialty"],["class","detail-item",4,"ngIf"],["class","record-section",4,"ngIf"],["name","videocam-outline",1,"detail-icon"],["name","medkit-outline",1,"detail-icon"],[1,"record-section"],[1,"section-content"],[1,"record-list"],[4,"ngFor","ngForOf"],[4,"ngIf"],["style","margin-top: 10px;",4,"ngFor","ngForOf"],[2,"margin-top","10px"],[1,"solid-border"],[1,"whiteSmoke-background",2,"padding","8px"],["size","8.5",1,"ion-no-padding"],["size","3.5","align","end",1,"ion-no-padding","align-column-center"],["class","top-border",3,"innerHtml",4,"ngIf"],["class","ion-no-padding top-border","style","padding: 8px",4,"ngIf"],["style","margin: 9px",4,"ngIf"],[1,"top-border",3,"innerHtml"],[1,"ion-no-padding","top-border",2,"padding","8px"],["size","8",1,"ion-no-padding"],["size","4",1,"ion-no-padding"],[2,"width","fit-content","float","right"],[2,"margin","9px"],[1,"ion-no-padding"],["size","12","padding-top","","align","center",4,"ngFor","ngForOf"],["size","12","padding-top","","align","center"],["fill","clear",1,"ion-no-padding","attachment-button",3,"disabled"],[2,"width","100%",3,"click","hidden","src"],[1,"file-placeholder",3,"click","hidden"],["name","document-outline"],[1,"file-type"],[1,"bodyText"],["class","text-body-xs",4,"ngIf"],["class","top-border","style","padding: 2px;",4,"ngIf"],[1,"text-body-xs"],["align","center",2,"padding-bottom","11px"],["size","3.5",1,"ion-no-padding",2,"padding-left","1px"],["size","2.5",1,"ion-no-padding"],["size","3",1,"ion-no-padding"],["size","3",1,"ion-no-padding",2,"padding-right","1px"],["size","2.5","align","end",1,"ion-no-padding",2,"padding-right","5px"],[1,"top-border",2,"padding","2px"],["size","12"],[1,"section-header"],["fill","clear",1,"download-button",3,"click"],["slot","icon-only","name","arrow-down-circle-outline"],[1,"prescription-list"],["class","prescription-item",4,"ngFor","ngForOf"],[1,"prescription-item"],[1,"prescription-number"],[1,"prescription-details"],[1,"drug-name"],[1,"dosage-info"],[1,"section-content",3,"innerHtml"],["vertical","bottom","horizontal","end","slot","fixed","margin-end","","margin-bottom","",1,"button-secondary",2,"cursor","pointer"],[1,"emr-download-ion",3,"click"],["src","assets/icon/download.svg"]],template:function(n,o){1&n&&(t.j41(0,"ion-content",0),t.DNE(1,T,4,0,"div",1)(2,gt,38,20,"div",2),t.k0s(),t.DNE(3,pt,3,0,"ion-fab",3)),2&n&&(t.R7$(),t.Y8G("ngIf",o.emrData),t.R7$(),t.Y8G("ngIf",o.emr&&!o.emrData),t.R7$(),t.Y8G("ngIf",o.emr&&!o.emrData))},dependencies:[m.bv,m.mC,m.Jm,m.hU,m.W9,m.Q8,m.lO,m.iq,m.ln,f.bT,f.pM,f.MD,f.Pc,f.vh],styles:[".emr-page[_ngcontent-%COMP%]{--padding-top: var(--mc-spacing-2xl);--padding-bottom: var(--mc-spacing-2xl)}.emr-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:0 var(--mc-spacing-xl)}.emr-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:var(--mc-spacing-2xl)}.emr-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--font-heading-lg);font-weight:600;color:var(--color-gray-900);margin:0 0 var(--mc-spacing-xs) 0}.emr-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--font-body-md);color:var(--color-gray-600);margin:0;font-weight:400}.emr-page[_ngcontent-%COMP%]   .visit-card[_ngcontent-%COMP%]{background:var(--color-white);border-radius:var(--radius-lg);padding:var(--spacing-4) var(--spacing-5);box-shadow:var(--shadow-sm);margin-bottom:var(--spacing-5);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.emr-page[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:var(--font-heading-sm);font-weight:600;color:var(--color-gray-700);margin:0 0 var(--spacing-3) 0}.emr-page[_ngcontent-%COMP%]   .visit-details[_ngcontent-%COMP%]{margin-bottom:var(--spacing-2)}.emr-page[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding:var(--spacing-3) 0}.emr-page[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid var(--color-gray-100)}.emr-page[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:first-child   .detail-content[_ngcontent-%COMP%]{font-weight:600;color:var(--mc-text-primary)}.emr-page[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{font-size:var(--font-heading-md);color:var(--mc-color-primary-500);margin-right:var(--mc-spacing-lg);flex-shrink:0;margin-top:2px}.emr-page[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]{flex:1;line-height:1.5;font-size:var(--font-body-md);color:var(--mc-text-primary)}.emr-page[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .doctor-name[_ngcontent-%COMP%]{font-weight:600;margin-bottom:var(--spacing-1);color:var(--mc-text-primary)}.emr-page[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .specialty[_ngcontent-%COMP%]{color:var(--color-gray-600);font-size:var(--font-body-sm)}.emr-page[_ngcontent-%COMP%]   .record-section[_ngcontent-%COMP%]{background:var(--color-white);border-radius:var(--radius-lg);padding:var(--spacing-4) var(--spacing-5);box-shadow:var(--shadow-sm);margin-bottom:var(--spacing-4);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.emr-page[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-3)}.emr-page[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   .download-button[_ngcontent-%COMP%]{--color: var(--mc-color-primary-500);margin:0;font-size:var(--font-heading-md)}.emr-page[_ngcontent-%COMP%]   .section-content[_ngcontent-%COMP%]{color:var(--mc-text-primary);font-size:var(--font-body-md);line-height:1.6}.emr-page[_ngcontent-%COMP%]   .record-list[_ngcontent-%COMP%]{list-style-type:disc;padding-left:var(--spacing-5);margin:0}.emr-page[_ngcontent-%COMP%]   .record-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:var(--spacing-1) 0;color:var(--mc-text-primary);font-size:var(--font-body-md);line-height:1.5}.emr-page[_ngcontent-%COMP%]   .prescription-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--spacing-3)}.emr-page[_ngcontent-%COMP%]   .prescription-item[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-3);padding:var(--spacing-3);background:var(--color-gray-50);border-radius:var(--radius-md);border-left:3px solid var(--mc-color-primary-500)}.emr-page[_ngcontent-%COMP%]   .prescription-number[_ngcontent-%COMP%]{font-weight:700;color:var(--mc-color-primary-500);font-size:var(--font-body-md);flex-shrink:0}.emr-page[_ngcontent-%COMP%]   .prescription-details[_ngcontent-%COMP%]{flex:1}.emr-page[_ngcontent-%COMP%]   .prescription-details[_ngcontent-%COMP%]   .drug-name[_ngcontent-%COMP%]{font-weight:600;color:var(--mc-text-primary);font-size:var(--font-body-md);margin-bottom:var(--spacing-1)}.emr-page[_ngcontent-%COMP%]   .prescription-details[_ngcontent-%COMP%]   .dosage-info[_ngcontent-%COMP%]{color:var(--color-gray-600);font-size:var(--font-body-sm)}.emr-page[_ngcontent-%COMP%]   .solid-border[_ngcontent-%COMP%]{border:1px solid var(--color-gray-200);border-radius:var(--radius-md);overflow:hidden;margin-top:var(--spacing-3)}.emr-page[_ngcontent-%COMP%]   .whiteSmoke-background[_ngcontent-%COMP%]{background:var(--color-gray-100);padding:var(--spacing-2)}.emr-page[_ngcontent-%COMP%]   .top-border[_ngcontent-%COMP%]{border-top:1px solid var(--color-gray-200);padding:var(--spacing-2)}.emr-page[_ngcontent-%COMP%]   .attachment-button[_ngcontent-%COMP%]{margin:0;width:100%;--padding-start: 0;--padding-end: 0}.emr-page[_ngcontent-%COMP%]   .attachment-button[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:var(--radius-md)}.emr-page[_ngcontent-%COMP%]   .file-placeholder[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:200px;background:var(--color-gray-50);border:2px dashed var(--color-gray-300);border-radius:var(--radius-md);cursor:pointer;transition:all .2s}.emr-page[_ngcontent-%COMP%]   .file-placeholder[_ngcontent-%COMP%]:hover{background:var(--color-gray-100);border-color:var(--mc-color-primary-500)}.emr-page[_ngcontent-%COMP%]   .file-placeholder[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:48px;color:var(--color-gray-400);margin-bottom:var(--spacing-2)}.emr-page[_ngcontent-%COMP%]   .file-placeholder[_ngcontent-%COMP%]   .file-type[_ngcontent-%COMP%]{font-size:var(--font-body-sm);font-weight:600;color:var(--color-gray-600);text-transform:uppercase}.emr-page[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{transform:translateY(-85px);margin-right:var(--spacing-4);z-index:1001}@supports (padding-bottom: env(safe-area-inset-bottom)){.emr-page[_ngcontent-%COMP%]   ion-fab[_ngcontent-%COMP%]{transform:translateY(calc(-85px - env(safe-area-inset-bottom)))}}.emr-page[_ngcontent-%COMP%]   .emr-download-ion[_ngcontent-%COMP%]{width:56px;height:56px;background:var(--mc-color-primary-500);box-shadow:var(--shadow-lg);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s}.emr-page[_ngcontent-%COMP%]   .emr-download-ion[_ngcontent-%COMP%]:hover{background:var(--mc-color-primary-600);transform:scale(1.05)}.emr-page[_ngcontent-%COMP%]   .emr-download-ion[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:24px;height:24px;filter:brightness(0) invert(1)}.emr-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--spacing-6) var(--spacing-4);color:var(--color-gray-500);animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}.emr-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:var(--spacing-4);color:var(--color-gray-400)}.emr-page[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:var(--font-body-md);margin:0}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 600px){.emr-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:0 var(--mc-spacing-md)}.emr-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--font-heading-md)}.emr-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--font-body-sm)}.emr-page[_ngcontent-%COMP%]   .visit-card[_ngcontent-%COMP%], .emr-page[_ngcontent-%COMP%]   .record-section[_ngcontent-%COMP%]{padding:var(--spacing-3) var(--spacing-4)}.emr-page[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{padding:var(--spacing-2) 0}.emr-page[_ngcontent-%COMP%]   .prescription-item[_ngcontent-%COMP%]{padding:var(--spacing-2)}}.align-column-center[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.bodyText[_ngcontent-%COMP%]{color:var(--mc-text-primary);font-size:var(--font-body-md);line-height:1.6}.extraRowSpacing[_ngcontent-%COMP%]{padding-top:var(--spacing-2)}"]}),a})()},8135:(I,M,c)=>{c.d(M,{V:()=>t});var v=c(4438),m=c(600),f=c(9012);let t=(()=>{var h;class y{constructor(s,d){this.platform=s,this.router=d,this.activeSubscriptions=new Map}setupBackButton(s,d){Array.isArray(s)?s.forEach(g=>{this.setupSingleBackButton(g.route,g.handler)}):"string"==typeof s&&d&&this.setupSingleBackButton(s,d)}setupSingleBackButton(s,d){this.cleanupBackButton(s);const g=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===s&&d()});this.activeSubscriptions.set(s,g)}cleanupBackButton(s){const d=this.activeSubscriptions.get(s);d&&(d.unsubscribe(),this.activeSubscriptions.delete(s))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((s,d)=>{s.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(s="/home"){window.history.length>1?window.history.back():this.router.navigate([s])}smartNavigateBack(s){const g={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[s];g?this.router.navigate([g]):this.navigateBack()}}return(h=y).\u0275fac=function(s){return new(s||h)(v.KVO(m.OD),v.KVO(f.Ix))},h.\u0275prov=v.jDH({token:h,factory:h.\u0275fac,providedIn:"root"}),y})()}}]);