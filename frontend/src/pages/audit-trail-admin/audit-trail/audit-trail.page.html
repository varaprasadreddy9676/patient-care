<ion-header no-border padding-bottom>
  <ion-toolbar class="primaryDark">
    <!-- <ion-buttons slot="start">
      <ion-back-button text="" defaultHref="home" icon="chevron-back-outline">
      </ion-back-button>
    </ion-buttons> -->
    <ion-title class="titleHeader">
      <ion-text class="titleText">Audit Trail</ion-text>
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>


  <ion-grid padding-horizontal class="ion-no-padding">
    <ion-row padding-horizontal class="ion-no-padding">
      <ion-col size="5.8" class="ion-no-padding">
        <mat-form-field class="input">
          <span matPrefix>+91 &nbsp;</span>
          <input type="tel" matInput maxlength="10" name="phone" placeholder="Phone Number" [(ngModel)]="phoneNumber"
            autocomplete="off" (blur)="getUserId()">
          <mat-icon matSuffix>call</mat-icon>
        </mat-form-field>
      </ion-col>

      <ion-col size="5.8" offset="0.4" class="ion-no-padding">
        <mat-form-field class="input">
          <mat-label>Event</mat-label>
          <mat-select name="eventName" [(ngModel)]="eventName">

            <mat-option>All</mat-option>

            <mat-option *ngFor="let event of events" [value]="event.name">
              {{ toTitleCase(event.name) }}
            </mat-option>


          </mat-select>
        </mat-form-field>
      </ion-col>

    </ion-row>


    <ion-row padding-horizontal class="ion-no-padding">

      <ion-col size="4.5" class="ion-no-padding">
        <mat-form-field class="input">
          <input matInput [matDatepicker]="picker" placeholder="From Date"
                  name="date" [(ngModel)]="fromDate" autocomplete="off" 
                  readonly="true" [max]="maxDate" >
                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </ion-col>

      <ion-col size="4.5" offset="0.6" class="ion-no-padding">
        <mat-form-field class="input">
          <input matInput [matDatepicker]="picker" placeholder="To Date"
                  name="date" [(ngModel)]="toDate" autocomplete="off" 
                  readonly="true" [max]="maxDate" >
                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </ion-col>

      <ion-col size="1" offset="0.2" class="ion-no-padding">
        <ion-button (click)="searchAudit()" [disabled]="disableSearch" fill="clear" class="button-size" translucent>
          <ion-icon style="zoom: 1.8;" class="secondaryText" name="search-outline"></ion-icon>
        </ion-button>
      </ion-col>

      <ion-col size="1" offset="0.2" class="ion-no-padding">
        <ion-button (click)="clearFields()" [disabled]="disableSearch" fill="clear" class="button-size" translucent>
          <ion-icon style="zoom: 2.2;" class="warningText" name="close-outline"></ion-icon>
        </ion-button>
      </ion-col>

    </ion-row>
  </ion-grid>

  <div class="example-container mat-elevation-z0" padding-horizontal padding-bottom *ngIf="auditInfo.length > 0">
    <table mat-table [dataSource]="auditInfo">


      <ng-container matColumnDef="UserId">
        <th mat-header-cell *matHeaderCellDef class="header"> UserId </th>
        <td mat-cell *matCellDef="let auditInfo"> {{ auditInfo.userId }} </td>
      </ng-container>


      <ng-container matColumnDef="UserName">
        <th mat-header-cell *matHeaderCellDef class="header"> UserName </th>
        <td mat-cell *matCellDef="let auditInfo"> {{ auditInfo.userName }} </td>
      </ng-container>


      <ng-container matColumnDef="Event">
        <th mat-header-cell *matHeaderCellDef class="header"> Event </th>
        <td mat-cell *matCellDef="let auditInfo"> {{ toTitleCase(auditInfo.event) }} </td>
      </ng-container>


      <ng-container matColumnDef="EventDetails">
        <th mat-header-cell *matHeaderCellDef class="header"> Event Details </th>
        <td mat-cell *matCellDef="let auditInfo"> {{ auditInfo.details }} </td>
      </ng-container>

      <ng-container matColumnDef="ObjectDetails">
        <th mat-header-cell *matHeaderCellDef class="header"> Details </th>
        <td mat-cell *matCellDef="let auditInfo" align="center">
          <ion-icon *ngIf="auditInfo.referenceObject" (click)="openUserInformationDialog(auditInfo.referenceObject)"
            style="zoom: 2.0" name="document-text-outline"></ion-icon>
        </td>
      </ng-container>

      <tr mat-header-row class="primaryLight" *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>


</ion-content>