/**
 * MedicsCare Theme System - Main Entry Point
 *
 * This file imports and organizes all theme modules.
 * Import this file in your global styles to enable the complete theme system.
 *
 * Usage:
 * @import '~@/shared/styles/theme-main';
 */

// ===================================
// üé® CORE THEME SYSTEM
// ===================================

// Import core theme tokens (required)
@import './theme-core';

// Import medical context colors (healthcare-specific)
@import './theme-medical';

// Import dark theme support
@import './theme-dark';

// Import Ionic bridge for compatibility
@import './theme-ionic-bridge';

// Import utility classes
@import './theme-utilities';

// ===================================
// üéØ MODERN COMPONENT STYLES
// ===================================

// Import modern card styles with rounded edges
@import './modern-cards';

// Import modern header styles
@import './modern-headers';

// Import standardized component styles (buttons, forms, modals, etc.)
@import './component-styles';

// Import unified input skin
@import './input-skin';

// Import Material Angular component overrides
@import './material-overrides';

// ===================================
// üåü THEME SYSTEM INITIALIZATION
// ===================================

// Apply theme-specific classes to root element
:root {
  // Theme system initialization
  --theme-version: '1.0.0';
  --theme-initialized: true;
}

// ===================================
// üéØ THEME SYSTEM ENHANCEMENTS
// ===================================

// Enable smooth transitions for theme switching
* {
  transition: background-color var(--mc-transition-base),
              color var(--mc-transition-base),
              border-color var(--mc-transition-base),
              box-shadow var(--mc-transition-base);
}

// Optimize transitions for theme switching
.theme-transition-smooth * {
  transition-duration: var(--mc-transition-base) !important;
}

.theme-transition-fast * {
  transition-duration: var(--mc-transition-fast) !important;
}

.theme-transition-none * {
  transition-duration: 0s !important;
}

// ===================================
// ‚ôø ACCESSIBILITY ENHANCEMENTS
// ===================================

// Improved focus indicators for keyboard navigation
:focus {
  outline: var(--mc-focus-width) solid var(--mc-focus-color);
  outline-offset: var(--mc-focus-offset);
}

// Enhanced focus for better visibility
.focus-ring {
  outline: var(--mc-focus-width) solid var(--mc-focus-color);
  outline-offset: var(--mc-focus-offset);
}

// High contrast mode enhancements
@media (prefers-contrast: high) {
  :root {
    --mc-input-focus-ring-size: 4px;
    --mc-input-focus-ring-color: var(--mc-color-primary-400);
    --mc-input-invalid-ring-color: var(--mc-color-error-400);
  }

  :focus {
    outline-width: calc(var(--mc-focus-width) * 1.5);
  }

  .focus-ring {
    outline-width: calc(var(--mc-focus-width) * 1.5);
  }
}

// ===================================
// üè• MEDICAL CONTEXT STYLING
// ===================================

// Patient status body classes for contextual styling
body.patient-active {
  --mc-context-primary: var(--mc-patient-active-text);
  --mc-context-bg: var(--mc-patient-active-bg);
  --mc-context-border: var(--mc-patient-active-border);
}

body.patient-inactive {
  --mc-context-primary: var(--mc-patient-inactive-text);
  --mc-context-bg: var(--mc-patient-inactive-bg);
  --mc-context-border: var(--mc-patient-inactive-border);
}

body.patient-pending {
  --mc-context-primary: var(--mc-patient-pending-text);
  --mc-context-bg: var(--mc-patient-pending-bg);
  --mc-context-border: var(--mc-patient-pending-border);
}

body.patient-critical {
  --mc-context-primary: var(--mc-patient-critical-text);
  --mc-context-bg: var(--mc-patient-cending-critical-bg);
  --mc-context-border: var(--mc-patient-critical-border);

  // Add pulsing animation for critical status
  animation: critical-pulse 2s ease-in-out infinite;
}

@keyframes critical-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

// ===================================
// üì± DEVICE-SPECIFIC OPTIMIZATIONS
// ===================================

// Mobile device optimizations
@media (max-width: 768px) {
  // Reduce animations for better performance
  * {
    transition-duration: var(--mc-transition-fast) !important;
  }

  // Increase touch target sizes
  .btn, button, .clickable {
    min-height: 44px;
    min-width: 44px;
  }
}

// High DPI screen optimizations
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  // Sharper borders for retina displays
  .card, .btn, input, select {
    border-width: 0.5px;
  }
}

// ===================================
// üé® THEME TESTING UTILITIES
// ===================================

// Development mode theme testing
.theme-test-mode {
  // Visualize theme boundaries
  [class*="bg-"] {
    position: relative;

    &::after {
      content: attr(class);
      position: absolute;
      top: 0;
      left: 0;
      font-size: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 2px 4px;
      border-radius: 2px;
      pointer-events: none;
    }
  }

  // Visualize spacing tokens
  [class*="p-"], [class*="m-"] {
    position: relative;
  }
}

// Theme validation mode
.theme-validation-mode {
  // Highlight missing theme tokens
  :root {
    --check-missing-token: var(--undefined-token, 'missing');
  }

  // Highlight hardcoded colors (visual aid for development)
  [style*="color:"], [style*="background:"], [style*="background-color:"], [style*="border-color:"] {
    outline: 2px solid red !important;
    outline-offset: 2px !important;

    &::before {
      content: '‚ö†Ô∏è Hardcoded color';
      position: absolute;
      top: -20px;
      left: 0;
      background: red;
      color: white;
      padding: 2px 4px;
      font-size: 10px;
      border-radius: 2px;
      z-index: 9999;
    }
  }
}

// ===================================
// üîÑ FALLBACK MECHANISMS
// ===================================

// Fallback for when theme variables are not defined
@supports not (--mc-bg-primary: var(--mc-color-neutral-50)) {
  :root {
    // Fallback colors using CSS variables
    --mc-bg-primary: #f9fafb;
    --mc-text-primary: #111827;
    --mc-border-primary: #d1d5db;
    --mc-color-primary-500: #002582;
    --mc-color-success-500: #059669;
    --mc-color-warning-500: #d97706;
    --mc-color-error-500: #dc3545;
  }
}

// ===================================
// üéØ THEME SYSTEM DEBUGGING
// ===================================

// Debug mode for theme development
.theme-debug-mode {
  // Show current theme info
  &::before {
    content: 'Theme: ' var(--mc-theme-name, 'unknown') ' | Mode: ' var(--mc-theme-mode, 'light');
    position: fixed;
    top: 0;
    left: 0;
    background: var(--mc-color-primary-500);
    color: white;
    padding: 4px 8px;
    font-size: 12px;
    z-index: 9999;
    border-bottom-right-radius: 4px;
  }

  // Show theme variable values on hover
  [class*="bg-"]:hover, [class*="text-"]:hover, [class*="border-"]:hover {
    position: relative;

    &::after {
      content: attr(style);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 10px;
      white-space: nowrap;
      z-index: 1000;
    }
  }
}

// ===================================
// üèÅ THEME SYSTEM COMPLETE
// ===================================

// Add theme initialization marker
.theme-system-loaded::before {
  content: 'MedicsCare Theme System v1.0.0 loaded';
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: var(--mc-color-success-500);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  opacity: 0.7;
  pointer-events: none;
}

// Remove initialization marker after 3 seconds
.theme-system-loaded::after {
  animation: fadeOut 1s ease-in-out 2s forwards;
}

@keyframes fadeOut {
  to { opacity: 0; visibility: hidden; }
}
