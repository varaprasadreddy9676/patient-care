"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5033],{5033:(V,f,a)=>{a.r(f),a.d(f,{PICK_FORMATS:()=>M,PickDateAdapter:()=>C,ProfileEditionPage:()=>x});var p=a(467),g=a(9893),u=a(5084),m=a(3),h=a(177),_=a(3719),O=a(9631),c=a(9417),v=a(5951),e=a(4438),P=a(600),y=a(8023),b=a(5351),E=a(9012),D=a(9934),N=a(7031),k=a(3629),S=a(8251),B=a(8135),U=a(740);const A=["fileInput"];function I(l,d){if(1&l&&(e.j41(0,"mat-radio-button",27),e.EFF(1),e.k0s()),2&l){const s=d.$implicit;e.Y8G("value",s),e.R7$(),e.SpI(" ",s.name," ")}}const M={parse:{dateInput:{month:"numeric",year:"numeric",day:"numeric"}},display:{dateInput:"input",monthYearLabel:{year:"numeric",month:"numeric"},dateA11yLabel:{year:"numeric",month:"numeric",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"numeric"}}};let C=(()=>{var l;class d extends m.xW{format(t,i){return"input"===i?(0,h.Yq)(t,"dd/MM/yyyy",this.locale):t.toDateString()}}return(l=d).\u0275fac=(()=>{let s;return function(i){return(s||(s=e.xGo(l)))(i||l)}})(),l.\u0275prov=e.jDH({token:l,factory:l.\u0275fac}),d})(),x=(()=>{var l;class d{constructor(t,i,r,o,n,R,j,T,F,L,w){this.platform=t,this.httpService=i,this.navCtrl=r,this.dialog=o,this.router=n,this.utilityService=R,this.dateService=j,this.storageService=T,this.navService=F,this.pageNavService=L,this.backButtonService=w,this.states=[],this.maxDate=new Date,this.genders=this.utilityService.getGenders(),this.navService.pageChange("Profile")}ionViewWillEnter(){this.navService.pageChange("Profile"),this.user=this.storageService.get("user"),this.firstName=this.user.firstName,this.lastName=this.user.lastName;const t=this.utilityService.getGenderIndex(this.user.gender);if(this.gender=void 0!==t?this.genders[t-1]:"Unknown",this.dateOfBirth=this.dateService.dateStringToDate(this.user.dob),this.city=this.user.cityName,this.phoneNumber=this.user.phone,this.email=" "===this.user.email?"":this.user.email,this.profilePictureUrl=this.user.profilePicture,!this.user)return this.utilityService.presentAlert("Error","User data not found. Please log in again."),void this.router.navigate(["/login"]);this.pageNavService.setupBackButton("/profile-edition",()=>{this.router.navigate(["home"])})}pickerOpen(t){this.datePickerBox=t,this.datePickerBox.open()}ionViewDidEnter(){this.backButtonService.registerPageHandler(this.router.url,()=>{this.datePickerBox&&this.datePickerBox.opened?this.datePickerBox.close():this.backButtonService.navigateBack()})}ionViewWillLeave(){this.backButtonService.unregisterPageHandler(this.router.url)}triggerFileInput(){this.fileInput.nativeElement.click()}uploadProfilePicture(){return(0,p.A)(function*(){})()}onFileSelected(t){var i;const r=null===(i=t.target.files)||void 0===i?void 0:i[0];if(r){const o=new FileReader;o.onload=n=>{this.profilePictureUrl=n.target.result,this.utilityService.presentToast("Profile picture updated successfully!",2e3)},o.onerror=n=>{this.utilityService.presentAlert("Error","Failed to read the selected file. Please try again.")},o.readAsDataURL(r)}}validateUser(){const i=/^([A-Za-z ]{1,60})?$/;this.firstName?i.test(this.firstName)?!this.lastName||i.test(this.lastName)?this.gender?this.dateOfBirth?!this.email||/^([a-zA_Z0-9\.-]+)@([a-z0-9]+)\.([a-z]{2,8})(\.[a-z]{2,8})?$/.test(this.email.toLowerCase())?this.phoneNumber?10===this.phoneNumber.toString().length?this.editProfile():this.utilityService.presentAlert("Invalid phone number","Enter a valid phone number."):this.utilityService.presentAlert("Invalid phone number","Please enter your phone number."):this.utilityService.presentAlert("Invalid email","Please enter a valid email."):this.utilityService.presentAlert("DOB is mandatory","Please enter your date of birth."):this.utilityService.presentAlert("Gender is mandatory","Please select the gender."):this.utilityService.presentAlert("Invalid last name","Last name can contain alphabets only."):this.utilityService.presentAlert("Invalid first name","First name can contain alphabets only."):this.utilityService.presentAlert("First name is mandatory","Enter your first name.")}editProfile(){var t=this;return(0,p.A)(function*(){const i=t.getRequestJSONObject(),r="/signup/"+t.user.id;try{(yield t.httpService.put(r,i))&&(t.router.navigate(["home"]),t.city&&t.selectedCity?(t.user.city=t.selectedCity._id?t.selectedCity._id:null,t.user.cityName=t.selectedCity.cityName?t.selectedCity.cityName:null):(t.user.city=null,t.user.cityName=null),t.user.dob=t.dateOfBirth,t.user.email=t.email?t.email.toLowerCase():null,t.user.gender=t.gender.name,t.user.phone=t.phoneNumber,t.user.firstName=t.utilityService.toTitleCase(t.firstName),t.user.lastName=t.utilityService.toTitleCase(t.lastName),t.user.profilePicture=t.profilePictureUrl,t.updateUser(t.user))}catch(o){t.utilityService.presentAlert("Error!",o.status&&11e3===o.error.code?t.phoneNumber+" is already registered. Please enter a different phone number.":o.message)}})()}getRequestJSONObject(){return{_id:this.user.id,firstName:this.utilityService.toTitleCase(this.firstName),lastName:this.utilityService.toTitleCase(this.lastName),gender:this.gender.name,dob:this.dateService.toDBdateFormat(this.dateOfBirth),city:this.selectedCity?this.selectedCity._id:null,cityName:this.selectedCity?this.selectedCity.cityName:null,phone:this.phoneNumber,email:this.email?this.email.toLowerCase():null,profilePicture:this.profilePictureUrl}}getCities(){var t=this;return(0,p.A)(function*(){const i="/city/?searchStr="+t.city;yield t.httpService.get(i).then(r=>{r&&t.city.length>1&&(t.states=r)}).catch(r=>{})})()}getSelectedCity(t){this.selectedCity=t}firstNameValidate(t){t.key&&t.key.match("[A-Za-z ]")||(this.firstName=this.firstName.substr(0,this.firstName.length-1))}lastNameValidate(t){t.key&&t.key.match("[A-Za-z ]")||(this.lastName=this.lastName.substr(0,this.lastName.length-1))}numberValidate(t){t.key&&t.key.match("[0-9]")||(this.phoneNumber=this.phoneNumber.substr(0,this.phoneNumber.length-1))}updateUser(t){this.storageService.set("user",t,!0)}ngOnInit(){}ngOnDestroy(){this.pageNavService.cleanup()}}return(l=d).\u0275fac=function(t){return new(t||l)(e.rXU(P.OD),e.rXU(y.k),e.rXU(P.q9),e.rXU(b.bZ),e.rXU(E.Ix),e.rXU(D.Q),e.rXU(N.k),e.rXU(k.n),e.rXU(S.o),e.rXU(B.V),e.rXU(U.D))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-profile-edition"]],viewQuery:function(t,i){if(1&t&&e.GBs(A,5),2&t){let r;e.mGM(r=e.lsd())&&(i.fileInput=r.first)}},standalone:!0,features:[e.Jv_([{provide:m.MJ,useClass:C},{provide:m.de,useValue:M},{provide:_.U$,useValue:{appearance:"outline"}}]),e.aNF],decls:47,vars:10,consts:[["fileInput",""],["picker",""],[1,"profile-edition-page"],[1,"container"],[1,"header"],[1,"subtitle"],[1,"form-card"],[1,"profile-picture-section"],[1,"profile-picture-container",3,"click"],["alt","Profile Picture",1,"profile-picture",3,"src"],[1,"upload-overlay"],["name","camera-outline"],[1,"upload-text"],["type","file","accept","image/*",2,"display","none",3,"change"],[1,"form-group"],[1,"form-label"],["name","firstName","placeholder","Enter your full name","required","","autocomplete","off",1,"form-input",3,"ngModelChange","keyup","ngModel"],["name","gender","required","",1,"radio-group",3,"ngModelChange","ngModel"],["class","radio-button","required","",3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"date-field"],["matInput","","placeholder","Select your date of birth","name","dob","autocomplete","off","required","",3,"ngModelChange","matDatepicker","ngModel","max"],["matIconSuffix","",3,"for"],["type","email","placeholder","Enter your email address","name","email",1,"form-input",3,"ngModelChange","ngModel"],["type","tel","maxlength","10","name","phoneNumber","placeholder","Enter your 10-digit mobile number","required","","autocomplete","off",1,"form-input",3,"ngModelChange","ngModel"],[1,"action-buttons"],["expand","block",1,"save-button",3,"click"],["slot","start","name","checkmark-circle-outline"],["required","",1,"radio-button",3,"value"]],template:function(t,i){if(1&t){const r=e.RV6();e.j41(0,"ion-content",2)(1,"div",3)(2,"header",4)(3,"h1"),e.EFF(4,"Edit Profile"),e.k0s(),e.j41(5,"p",5),e.EFF(6,"Update your personal information"),e.k0s()(),e.j41(7,"div",6)(8,"div",7)(9,"div",8),e.bIt("click",function(){return e.eBV(r),e.Njj(i.triggerFileInput())}),e.nrm(10,"img",9),e.j41(11,"div",10),e.nrm(12,"ion-icon",11),e.j41(13,"span",12),e.EFF(14,"Change Photo"),e.k0s()()(),e.j41(15,"input",13,0),e.bIt("change",function(n){return e.eBV(r),e.Njj(i.onFileSelected(n))}),e.k0s()(),e.j41(17,"form")(18,"div",14)(19,"label",15),e.EFF(20,"Full Name"),e.k0s(),e.j41(21,"ion-input",16),e.mxI("ngModelChange",function(n){return e.eBV(r),e.DH7(i.firstName,n)||(i.firstName=n),e.Njj(n)}),e.bIt("keyup",function(n){return e.eBV(r),e.Njj(i.firstNameValidate(n))}),e.k0s()(),e.j41(22,"div",14)(23,"label",15),e.EFF(24,"Gender"),e.k0s(),e.j41(25,"mat-radio-group",17),e.mxI("ngModelChange",function(n){return e.eBV(r),e.DH7(i.gender,n)||(i.gender=n),e.Njj(n)}),e.DNE(26,I,2,2,"mat-radio-button",18),e.k0s()(),e.j41(27,"div",14)(28,"label",15),e.EFF(29,"Date of Birth"),e.k0s(),e.j41(30,"mat-form-field",19)(31,"input",20),e.mxI("ngModelChange",function(n){return e.eBV(r),e.DH7(i.dateOfBirth,n)||(i.dateOfBirth=n),e.Njj(n)}),e.k0s(),e.nrm(32,"mat-datepicker-toggle",21)(33,"mat-datepicker",null,1),e.k0s()(),e.j41(35,"div",14)(36,"label",15),e.EFF(37,"Email Address"),e.k0s(),e.j41(38,"ion-input",22),e.mxI("ngModelChange",function(n){return e.eBV(r),e.DH7(i.email,n)||(i.email=n),e.Njj(n)}),e.k0s()(),e.j41(39,"div",14)(40,"label",15),e.EFF(41,"Mobile Number"),e.k0s(),e.j41(42,"ion-input",23),e.mxI("ngModelChange",function(n){return e.eBV(r),e.DH7(i.phoneNumber,n)||(i.phoneNumber=n),e.Njj(n)}),e.k0s()(),e.j41(43,"div",24)(44,"ion-button",25),e.bIt("click",function(){return e.eBV(r),e.Njj(i.validateUser())}),e.nrm(45,"ion-icon",26),e.EFF(46," Save Changes "),e.k0s()()()()()()}if(2&t){const r=e.sdS(34);e.R7$(10),e.Y8G("src",i.profilePictureUrl||"assets/icon/person_icon.svg",e.B4B),e.R7$(11),e.R50("ngModel",i.firstName),e.R7$(4),e.R50("ngModel",i.gender),e.R7$(),e.Y8G("ngForOf",i.genders),e.R7$(5),e.Y8G("matDatepicker",r),e.R50("ngModel",i.dateOfBirth),e.Y8G("max",i.maxDate),e.R7$(),e.Y8G("for",r),e.R7$(6),e.R50("ngModel",i.email),e.R7$(4),e.R50("ngModel",i.phoneNumber)}},dependencies:[g.bv,g.Jm,g.W9,g.iq,g.$w,g.Gw,_.rl,O.fg,c.YN,c.qT,c.me,c.BC,c.cb,c.YS,c.tU,c.vS,c.cV,v.VT,h.pM,v._g,u.bZ,u.bU,_.yw,u.Vh],styles:[".profile-edition-page[_ngcontent-%COMP%]{--padding-top: var(--mc-spacing-2xl);--padding-bottom: var(--mc-spacing-2xl);--background: var(--color-gray-50)}.profile-edition-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:500px;margin:0 auto;padding:var(--spacing-4) var(--spacing-3)}.profile-edition-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:var(--mc-spacing-2xl);text-align:center}.profile-edition-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg);font-weight:600;color:var(--color-gray-900);margin:0 0 var(--mc-spacing-xs) 0}.profile-edition-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md);color:var(--color-gray-600);margin:0;font-weight:400}.profile-edition-page[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]{background:var(--color-white);border-radius:var(--radius-lg);padding:var(--spacing-5) var(--spacing-4);box-shadow:var(--shadow-sm);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture-section[_ngcontent-%COMP%]{text-align:center;margin-bottom:var(--spacing-6);padding-bottom:var(--spacing-5);border-bottom:1px solid var(--color-gray-100)}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture-container[_ngcontent-%COMP%]{position:relative;width:120px;height:120px;border-radius:50%;overflow:hidden;cursor:pointer;margin:0 auto;border:4px solid var(--mc-color-primary-500);box-shadow:var(--shadow-md);transition:all .3s ease}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture-container[_ngcontent-%COMP%]:hover{border-color:var(--mc-color-primary-600);box-shadow:var(--shadow-lg);transform:scale(1.05)}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture-container[_ngcontent-%COMP%]:hover   .upload-overlay[_ngcontent-%COMP%]{opacity:1}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;display:block}.profile-edition-page[_ngcontent-%COMP%]   .upload-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background:#000000b3;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:var(--spacing-1);opacity:0;transition:opacity .3s ease}.profile-edition-page[_ngcontent-%COMP%]   .upload-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--color-white);font-size:var(--mc-icon-size-xl)}.profile-edition-page[_ngcontent-%COMP%]   .upload-overlay[_ngcontent-%COMP%]   .upload-text[_ngcontent-%COMP%]{color:var(--color-white);font-size:var(--mc-font-body-xs);font-weight:600}.profile-edition-page[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:var(--spacing-5)}.profile-edition-page[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:var(--spacing-4)}.profile-edition-page[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{display:block;font-size:var(--mc-font-body-sm);font-weight:600;color:var(--color-gray-700);margin-bottom:var(--spacing-2)}.profile-edition-page[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%;height:48px;border-radius:var(--radius-md);background:var(--color-gray-50);border:1px solid var(--color-gray-200);--padding-start: var(--spacing-3);--padding-end: var(--spacing-3);font-size:var(--mc-font-body-md);transition:all .2s ease}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]{width:100%}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{height:48px;border-radius:var(--radius-md);background:var(--color-gray-50);border:1px solid var(--color-gray-200);padding:0 var(--spacing-3);transition:all .2s ease}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]     .mat-mdc-text-field-wrapper{padding:0}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]     .mat-mdc-form-field-infix{padding:var(--spacing-2) 0;min-height:auto}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]     input{font-size:var(--mc-font-body-md);color:var(--mc-text-primary)}.profile-edition-page[_ngcontent-%COMP%]   .date-field[_ngcontent-%COMP%]     .mat-mdc-form-field-subscript-wrapper{display:none}.profile-edition-page[_ngcontent-%COMP%]   .radio-group[_ngcontent-%COMP%]{display:flex;gap:var(--spacing-4);flex-wrap:wrap}.profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-form-field{font-size:var(--mc-font-body-md);color:var(--mc-text-primary)}.profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-radio__outer-circle, .profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-radio__inner-circle{border-color:var(--mc-color-primary-500)}.profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-radio--checked .mdc-radio__outer-circle, .profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-radio--checked .mdc-radio__inner-circle{border-color:var(--mc-color-primary-500)}.profile-edition-page[_ngcontent-%COMP%]   .radio-button[_ngcontent-%COMP%]     .mdc-radio__background:before{background-color:var(--mc-color-primary-500)}.profile-edition-page[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-top:var(--spacing-6);padding-top:var(--spacing-4);border-top:1px solid var(--color-gray-100)}.profile-edition-page[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{--border-radius: var(--radius-md);--padding-top: var(--spacing-3);--padding-bottom: var(--spacing-3);--box-shadow: var(--shadow-md);--background: linear-gradient(90deg, var(--mc-color-primary-500), var(--mc-color-primary-600));--color: var(--color-white);font-weight:600;font-size:var(--mc-font-body-md);text-transform:none;letter-spacing:.3px;transition:all .3s ease}.profile-edition-page[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:hover{--background: linear-gradient(90deg, var(--mc-color-primary-600), var(--mc-color-primary-700));transform:translateY(-1px);--box-shadow: var(--shadow-lg)}.profile-edition-page[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]:active{transform:translateY(0)}.profile-edition-page[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:var(--spacing-2);font-size:var(--mc-icon-size-md)}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 600px){.profile-edition-page[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:var(--spacing-3) var(--spacing-2)}.profile-edition-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-md)}.profile-edition-page[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm)}.profile-edition-page[_ngcontent-%COMP%]   .form-card[_ngcontent-%COMP%]{padding:var(--spacing-4) var(--spacing-3)}.profile-edition-page[_ngcontent-%COMP%]   .profile-picture-container[_ngcontent-%COMP%]{width:100px;height:100px}.profile-edition-page[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:var(--spacing-4)}.profile-edition-page[_ngcontent-%COMP%]   .radio-group[_ngcontent-%COMP%]{flex-direction:column;gap:var(--spacing-3)}.profile-edition-page[_ngcontent-%COMP%]   .save-button[_ngcontent-%COMP%]{--padding-top: var(--spacing-2);--padding-bottom: var(--spacing-2);font-size:var(--mc-font-body-sm)}}"]}),d})()}}]);