"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8383],{8383:(F,f,o)=>{o.r(f),o.d(f,{ConfirmAppointmentPage:()=>w});var s=o(467),u=o(9893),v=o(177),t=o(4438),l=o(600),P=o(3226),g=o(3629),a=o(9012),c=o(8023),e=o(9934),b=o(7031),E=o(9849),B=o(8135);function I(r,d){1&r&&t.nrm(0,"ion-icon",19)}function S(r,d){1&r&&t.nrm(0,"ion-icon",20)}function _(r,d){1&r&&(t.j41(0,"span"),t.EFF(1,"Video Consultation"),t.k0s())}function D(r,d){1&r&&(t.j41(0,"span"),t.EFF(1,"Consultation at Hospital"),t.k0s())}function y(r,d){if(1&r&&(t.qex(0),t.j41(1,"div",21)(2,"span",22),t.EFF(3,"Amount to be paid"),t.k0s(),t.j41(4,"span",23),t.EFF(5),t.k0s()(),t.bVm()),2&r){const p=t.XpG();t.R7$(5),t.SpI("\u20b9",null==p.appointment.consultationCharge?null:p.appointment.consultationCharge.price,".00")}}function x(r,d){1&r&&(t.j41(0,"div",24),t.EFF(1," No payment required "),t.k0s())}function R(r,d){if(1&r){const p=t.RV6();t.j41(0,"ion-button",25),t.bIt("click",function(){t.eBV(p);const n=t.XpG();return t.Njj(n.bookAppointment(null))}),t.EFF(1," Proceed to Pay "),t.k0s()}if(2&r){const p=t.XpG();t.Y8G("disabled",p.disableButtons)}}function U(r,d){if(1&r){const p=t.RV6();t.j41(0,"ion-button",25),t.bIt("click",function(){t.eBV(p);const n=t.XpG();return t.Njj(n.bookAppointment(!0))}),t.EFF(1," Confirm Booking "),t.k0s()}if(2&r){const p=t.XpG();t.Y8G("disabled",p.disableButtons)}}let w=(()=>{var r;class d{constructor(i,n,h,m,C,k,A,T,N){var O,M;this.platform=i,this.appointmentPaymentService=n,this.storageService=h,this.router=m,this.httpService=C,this.utilityService=k,this.dateService=A,this.appointmentService=T,this.pageNavService=N,this.disableButtons=!1,this.hideProgressBar=!0,this.user=this.storageService.get("user"),this.appointment=null===(O=this.router.getCurrentNavigation())||void 0===O||null===(O=O.extras.state)||void 0===O?void 0:O.appointment,this.consentForm=null===(M=this.router.getCurrentNavigation())||void 0===M||null===(M=M.extras.state)||void 0===M?void 0:M.consentForm,this.checkFreeBooking()}ionViewWillEnter(){this.pageNavService.setupBackButton("/confirm-appointment",()=>{this.router.navigate(["appointment-booking"])}),this.pageNavService.setupBackButton("/home/confirm-appointment",()=>{this.router.navigate(["appointment-booking"])})}checkFreeBooking(){var i=this;return(0,s.A)(function*(){i.httpService.getInBackground("/doctor/freeBooking/?hospitalCode="+i.appointment.hospitalCode+"&doctorId="+i.appointment.doctorId+"&consultationChargeId="+i.appointment.consultationCharge.id+"&familyMemberId="+i.appointment.familyMemberId+"&specialityCode="+i.appointment.specialityCode+"&appointmentDate="+i.appointment.appointmentDate,!0).then(h=>{i.appointment.consultationCharge.price=h.charge.price}).catch(h=>{})})()}confirmBooking(i){var n=this;return(0,s.A)(function*(){n.httpService.put("/appointment/"+i._id+"/confirm",i).then(function(){var m=(0,s.A)(function*(C){if(C){n.hideProgressBar=!0,n.disableButtons=!1;const k={state:{appointment:i}};n.appointmentService.refreshAppointments(),n.router.navigate(["/home/appointment-confirmed"],k)}});return function(C){return m.apply(this,arguments)}}()).catch(m=>{n.hideProgressBar=!0,n.utilityService.presentAlert("Error!",m.message),n.router.navigate(["/home/appointment-list"]),n.disableButtons=!1}),n.appointmentService.refreshAppointments()})()}bookAppointment(i){this.disableButtons=!0,this.consentForm&&(this.appointment.consentForm={templateCode:this.consentForm.code,userId:this.user.id,userName:this.appointment.PatientName,familyMemberId:this.appointment.familyMemberId,hospitalCode:this.appointment.hospitalCode,contextType:"VIDEO_CONSULTATION",status:this.consentForm.status,template:this.consentForm.template}),this.httpService.post("/appointment",this.appointment).then(m=>{if(m){this.hideProgressBar=!1;const C=A=>{setTimeout(()=>{this.hideProgressBar=!0},4e3),this.disableButtons=!1,this.router.navigate(["/home/appointment-confirmed"],{state:{appointment:A}})},k=A=>{setTimeout(()=>{this.hideProgressBar=!0},4e3),this.disableButtons=!1,this.router.navigate(["/home/appointment-list"])};i?this.confirmBooking(m):this.appointmentPaymentService.makePayment(m,C,k)}}).catch(m=>{setTimeout(()=>{this.hideProgressBar=!0},1e3),this.router.navigate(["/home/appointment-list"]),this.disableButtons=!1,this.utilityService.presentAlert("Error!",m.message)}),this.appointmentService.refreshAppointments()}timeFormatTo12hour(i){return this.dateService.to12HourFormat(i)}sanitizeDoctorName(i){if(!i)return"";const n=i.trim();return n.toLowerCase().startsWith("dr.")||n.toLowerCase().startsWith("dr ")?n:"Dr. "+n}ngOnDestroy(){this.pageNavService.cleanupBackButton("/confirm-appointment"),this.pageNavService.cleanupBackButton("/home/confirm-appointment")}}return(r=d).\u0275fac=function(i){return new(i||r)(t.rXU(l.OD),t.rXU(P.j),t.rXU(g.n),t.rXU(a.Ix),t.rXU(c.k),t.rXU(e.Q),t.rXU(b.k),t.rXU(E.h),t.rXU(B.V))},r.\u0275cmp=t.VBU({type:r,selectors:[["app-confirm-appointment"]],standalone:!0,features:[t.aNF],decls:35,vars:16,consts:[[1,"appointment-confirmation"],[1,"container"],[1,"header"],[1,"subtitle"],[1,"appointment-details"],[1,"detail-item"],["name","person-outline",1,"detail-icon"],[1,"detail-content"],["name","calendar-outline",1,"detail-icon"],["name","medical-outline",1,"detail-icon"],[1,"doctor-name"],[1,"specialty"],["name","videocam-outline","class","detail-icon",4,"ngIf"],["name","medkit-outline","class","detail-icon",4,"ngIf"],[1,"detail-content","consultation-type"],[4,"ngIf"],["class","free-consultation-notice",4,"ngIf"],[1,"action-buttons"],["class","primary-button","expand","block",3,"disabled","click",4,"ngIf"],["name","videocam-outline",1,"detail-icon"],["name","medkit-outline",1,"detail-icon"],[1,"price-info"],[1,"price-label"],[1,"price-amount"],[1,"free-consultation-notice"],["expand","block",1,"primary-button",3,"click","disabled"]],template:function(i,n){1&i&&(t.j41(0,"ion-content",0)(1,"div",1)(2,"header",2)(3,"h1"),t.EFF(4,"Appointment Summary"),t.k0s(),t.j41(5,"p",3),t.EFF(6,"Review and confirm your details below"),t.k0s()(),t.j41(7,"div",4)(8,"div",5),t.nrm(9,"ion-icon",6),t.j41(10,"div",7),t.EFF(11),t.k0s()(),t.j41(12,"div",5),t.nrm(13,"ion-icon",8),t.j41(14,"div",7),t.EFF(15),t.nI1(16,"date"),t.k0s()(),t.j41(17,"div",5),t.nrm(18,"ion-icon",9),t.j41(19,"div",7)(20,"div",10),t.EFF(21),t.k0s(),t.j41(22,"div",11),t.EFF(23),t.k0s()()(),t.j41(24,"div",5),t.DNE(25,I,1,0,"ion-icon",12)(26,S,1,0,"ion-icon",13),t.j41(27,"div",14),t.DNE(28,_,2,0,"span",15)(29,D,2,0,"span",15)(30,y,6,1,"ng-container",15),t.k0s()()(),t.DNE(31,x,2,0,"div",16),t.j41(32,"div",17),t.DNE(33,R,2,1,"ion-button",18)(34,U,2,1,"ion-button",18),t.k0s()()()),2&i&&(t.R7$(11),t.SpI(" ",n.appointment.patientName," "),t.R7$(4),t.Lme(" ",t.i5U(16,13,n.appointment.appointmentDate,"MMM d, yyyy")," at ",n.timeFormatTo12hour(n.appointment.appointmentTime)," "),t.R7$(6),t.JRh(n.sanitizeDoctorName(n.appointment.doctorName)),t.R7$(2),t.JRh(n.appointment.specialityName),t.R7$(2),t.Y8G("ngIf",n.appointment.videoConsultation),t.R7$(),t.Y8G("ngIf",!n.appointment.videoConsultation),t.R7$(2),t.Y8G("ngIf",n.appointment.videoConsultation),t.R7$(),t.Y8G("ngIf",!n.appointment.videoConsultation),t.R7$(),t.Y8G("ngIf",(null==n.appointment.consultationCharge?null:n.appointment.consultationCharge.price)>0),t.R7$(),t.Y8G("ngIf",0===n.appointment.consultationCharge.price),t.R7$(2),t.Y8G("ngIf",n.appointment.consultationCharge.price>0),t.R7$(),t.Y8G("ngIf",0===n.appointment.consultationCharge.price))},dependencies:[u.bv,u.Jm,u.W9,u.iq,v.bT,v.vh],styles:[".appointment-confirmation[_ngcontent-%COMP%]{--padding-top: var(--mc-spacing-2xl);--padding-bottom: var(--mc-spacing-2xl)}.appointment-confirmation[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:0 var(--mc-spacing-xl);padding-bottom:160px}.appointment-confirmation[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{margin-bottom:var(--mc-spacing-2xl)}.appointment-confirmation[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-lg);font-weight:600;color:var(--color-gray-900);margin:0 0 var(--mc-spacing-xs) 0}.appointment-confirmation[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--mc-font-body-md);color:var(--color-gray-600);margin:0;font-weight:400}.appointment-confirmation[_ngcontent-%COMP%]   .appointment-details[_ngcontent-%COMP%]{background:var(--color-white);border-radius:var(--radius-lg);padding:var(--spacing-4) var(--spacing-5);box-shadow:var(--shadow-sm);animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.appointment-confirmation[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;padding:var(--spacing-3) 0}.appointment-confirmation[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid var(--color-gray-100)}.appointment-confirmation[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]:first-child   .detail-content[_ngcontent-%COMP%]{font-weight:600;color:var(--mc-text-primary)}.appointment-confirmation[_ngcontent-%COMP%]   .detail-icon[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-md);color:var(--mc-color-primary-500);margin-right:var(--mc-spacing-lg);flex-shrink:0;margin-top:2px}.appointment-confirmation[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]{flex:1;line-height:1.5}.appointment-confirmation[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .doctor-name[_ngcontent-%COMP%]{font-weight:600;margin-bottom:var(--spacing-1);color:var(--mc-text-primary)}.appointment-confirmation[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .specialty[_ngcontent-%COMP%]{color:var(--color-gray-600);font-size:var(--mc-font-body-sm)}.appointment-confirmation[_ngcontent-%COMP%]   .consultation-type[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--mc-spacing-lg)}.appointment-confirmation[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end}.appointment-confirmation[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]   .price-label[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm);color:var(--mc-text-secondary)}.appointment-confirmation[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]   .price-amount[_ngcontent-%COMP%]{font-weight:var(--mc-font-weight-medium);color:var(--mc-text-primary)}.appointment-confirmation[_ngcontent-%COMP%]   .free-consultation-notice[_ngcontent-%COMP%]{text-align:center;background:var(--color-gray-50);border-radius:var(--radius-md);padding:var(--spacing-3);color:var(--color-gray-700);margin:var(--mc-spacing-2xl) 0 var(--spacing-3) 0;font-size:var(--mc-font-body-sm);font-weight:500}.appointment-confirmation[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-xl);padding:0}.appointment-confirmation[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]{--background: linear-gradient(90deg, var(--color-primary-500), var(--color-primary-700));--color: var(--color-white);--border-radius: var(--radius-md);--padding-top: var(--mc-spacing-lg);--padding-bottom: var(--mc-spacing-lg);--box-shadow: var(--shadow-md);font-weight:600}.appointment-confirmation[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]:hover{--background: linear-gradient(90deg, var(--color-primary-700), var(--color-primary-800))}.appointment-confirmation[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]:active{transform:scale(.98)}.appointment-footer[_ngcontent-%COMP%]{--background: var(--color-white);--border-top: 1px solid var(--color-gray-100);padding:var(--mc-spacing-lg)}.appointment-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:0}.appointment-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]{--background: linear-gradient(90deg, var(--color-primary-500), var(--color-primary-700));--color: var(--color-white);--border-radius: var(--radius-md);--padding-top: var(--mc-spacing-lg);--padding-bottom: var(--mc-spacing-lg);--box-shadow: var(--shadow-md);font-weight:600}.appointment-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]:hover{--background: linear-gradient(90deg, var(--color-primary-700), var(--color-primary-800))}.appointment-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]:active{transform:scale(.98)}@media (max-width: 600px){.appointment-footer[_ngcontent-%COMP%]{padding:var(--mc-spacing-md)}.appointment-footer[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{padding:0}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.loading-progress[_ngcontent-%COMP%]{--progress-background: var(--mc-color-primary-500)}@media (max-width: 600px){.appointment-confirmation[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{padding:0 var(--mc-spacing-md);padding-bottom:180px}.appointment-confirmation[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:var(--mc-font-heading-md)}.appointment-confirmation[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:var(--mc-font-body-sm)}.appointment-confirmation[_ngcontent-%COMP%]   .appointment-details[_ngcontent-%COMP%]{padding:var(--spacing-3) var(--spacing-4)}.appointment-confirmation[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{padding:var(--spacing-2) 0}.appointment-confirmation[_ngcontent-%COMP%]   .consultation-type[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.appointment-confirmation[_ngcontent-%COMP%]   .consultation-type[_ngcontent-%COMP%]   .price-info[_ngcontent-%COMP%]{align-items:flex-start;margin-top:var(--mc-spacing-sm)}.appointment-confirmation[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-top:var(--mc-spacing-lg)}}"]}),d})()},8135:(F,f,o)=>{o.d(f,{V:()=>t});var s=o(4438),u=o(600),v=o(9012);let t=(()=>{var l;class P{constructor(a,c){this.platform=a,this.router=c,this.activeSubscriptions=new Map}setupBackButton(a,c){Array.isArray(a)?a.forEach(e=>{this.setupSingleBackButton(e.route,e.handler)}):"string"==typeof a&&c&&this.setupSingleBackButton(a,c)}setupSingleBackButton(a,c){this.cleanupBackButton(a);const e=this.platform.backButton.subscribeWithPriority(10,()=>{this.router.url===a&&c()});this.activeSubscriptions.set(a,e)}cleanupBackButton(a){const c=this.activeSubscriptions.get(a);c&&(c.unsubscribe(),this.activeSubscriptions.delete(a))}cleanupAllSubscriptions(){this.activeSubscriptions.forEach((a,c)=>{a.unsubscribe()}),this.activeSubscriptions.clear()}cleanup(){this.cleanupAllSubscriptions()}navigateBack(a="/home"){window.history.length>1?window.history.back():this.router.navigate([a])}smartNavigateBack(a){const e={"/appointment-list":"/home","/appointment-booking":"/appointment-list","/select-patient":"/appointment-booking","/confirm-appointment":"/appointment-booking","/appointment-confirmed":"/appointment-list","/appointment-details":"/appointment-list","/consent-form":"/appointment-booking","/prescription":"/home","/bills":"/home","/bill-details":"/bills","/family-member-list":"/home","/home/profiles":"/home","/family-member-form":"/home/profiles","/profile-edition":"/home","/attachment-list":"/home","/medical-record/attachment-list":"/home","/report-attachment-list":"/home","/medical-record/report-attachment-list":"/home","/family-member-attachment-list":"/home","/patient-medical-record":"/home","/patient-list":"/home","/emr-visits":"/patient-list","/emr":"/home","/medical-attachments":"/patient-medical-record","/facility-information":"/facility-information-template","/facility-information-template":"/home","/edit-facility-information-page":"/facility-information","/service-requests":"/home","/new-service-request":"/service-requests","/reminder":"/home"}[a];e?this.router.navigate([e]):this.navigateBack()}}return(l=P).\u0275fac=function(a){return new(a||l)(s.KVO(u.OD),s.KVO(v.Ix))},l.\u0275prov=s.jDH({token:l,factory:l.\u0275fac,providedIn:"root"}),P})()},3226:(F,f,o)=>{o.d(f,{j:()=>P});var s=o(4438),u=o(9934),v=o(8023),t=o(7793),l=o(9012);let P=(()=>{var g;class a{constructor(e,b,E,B){this.utilityService=e,this.httpService=b,this.paymentGatewayService=E,this.router=B,this.paymentType=3}makePayment(e,b,E){this.appointment=e,e.paymentDetails.upi&&(this.paymentType=e.paymentDetails.gatewayKey?3:1),e.paymentDetails.gatewayKey&&(this.paymentType=e.paymentDetails.upi?3:2),this.successCallbackFun=b,this.cancelCallbackFun=E,null!=e.paymentDetails.gatewayKey||null!=e.paymentDetails.upi?this.paymentGatewayService.makePayment({paymentGatewayKey:e.paymentDetails.gatewayKey,orderId:e._id,payerEmail:e.patient.email,payerName:e.patient.name,payerPhoneNumber:e.patient.phone,appName:"medics",amount:e.consultationCharge.price,description:e.consultationCharge.chargeName,upi:e.paymentDetails.upi?e.paymentDetails.upi:{name:"",id:""},paymentType:this.paymentType},_=>{this.appointment.paymentTransactionNo=_.razorpay_payment_id,this.appointment.paymentDetails.successResponse=_,this.httpService.put("/appointment/"+this.appointment._id+"/confirm",this.appointment).then(y=>{y||this.utilityService.presentAlert("Appointment not confirmed.","Your appointment is not confirmed due to some technical issue. Please contact the hospital with your payment details."),this.successCallbackFun(this.appointment)}).catch(y=>{this.utilityService.presentAlert("Appointment not confirmed.","Your appointment is not confirmed due to some technical issue. Please contact the hospital with your payment details."),this.router.navigate(["/home/appointment-details"],{state:{appointmentDetails:this.appointment}})})},_=>{console.log("Payment failed. "+_.description+" (Error "+_.code+")"),this.appointment.paymentDetails.errorResponse=_,this.utilityService.presentAlert("Payment Failed","Your payment against the appointment has failed. Please try again."),this.httpService.put("/appointment/"+this.appointment._id+"/paymentFailed",this.appointment).then(y=>{this.cancelCallbackFun(this.appointment)}).catch(y=>{})}):this.utilityService.presentAlert("Missing Payment Gateway Details","Payment gateway details are not configured for this hospital.")}}return(g=a).\u0275fac=function(e){return new(e||g)(s.KVO(u.Q),s.KVO(v.k),s.KVO(t.W),s.KVO(l.Ix))},g.\u0275prov=s.jDH({token:g,factory:g.\u0275fac,providedIn:"root"}),a})()}}]);